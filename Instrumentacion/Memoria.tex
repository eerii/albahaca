\documentclass[12pt, a4paper, titlepage]{article}

%INFORMACIÓN
\title{\textbf {Instrumentación Electrónica: Medición de circuitos de corriente continua y corriente alterna}}
\author{{\Large Pazos Pérez, José}\\DNI}
\date{}

%PAQUETES
%\usepackage[utf8]{inputenc} %Añadir acentos y caracteres (Windows y Linux)

\usepackage[dvipsnames]{xcolor} %Colorear texto y colores estándar
\usepackage{colortbl} %Colorear celdas de tablas
%COLOR
\definecolor{Black}{RGB}{31, 31, 31}
\definecolor{Brown}{RGB}{179, 131, 55}
\definecolor{Red}{RGB}{222, 94, 80}
\definecolor{Orange}{RGB}{245, 149, 76}
\definecolor{Yellow}{RGB}{247, 192, 62}
\definecolor{Green}{RGB}{122, 217, 119}
\definecolor{Blue}{RGB}{110, 176, 230}
\definecolor{Violet}{RGB}{176, 110, 230}
\definecolor{Grey}{RGB}{189, 189, 189}
\definecolor{DarkGrey}{RGB}{100, 100, 100}
\definecolor{White}{RGB}{245, 245, 245}
\definecolor{Golden}{RGB}{207, 194, 97}
\definecolor{Silver}{RGB}{179, 193, 196}
\definecolor{LinkBlue}{RGB}{20, 88, 224}

\usepackage[centertags]{amsmath} %Excluir ecuaciones de la enumeración automática
\usepackage{csvsimple} %Tablas desde archivos .csv
\usepackage{pgfplots} %Gráficas desde matplotlib con .pgf
\usepackage{graphicx} %Imágenes
\usepackage[siunitx]{circuitikz} %Circuitos
\usepackage{pythonhighlight} %Código de python
\pgfplotsset{compat=1.16}

\usepackage{tocloft} %Crear listas (por ejemplo, de ecuaciones)
\usepackage{enumitem} %Cambiar los estilos de las listas
\usepackage{verbatim} %Comentarios de varias lineas
\usepackage[margin=0.8in]{geometry} %Márgenes
\usepackage[skip=12pt]{parskip} %Añadir espacio tras los párrafos
\usepackage{float} %Controlar el posicionamiento de gráficas y tablas con H
\usepackage[toc,page]{appendix} %Anexos
\usepackage{chngcntr} %Numeración de capítulos por partes
\usepackage{hyperref} %Añadir vínculos
\hypersetup{
    colorlinks=true,
    linkcolor=LinkBlue,
    filecolor=Red,
    urlcolor=Blue,
}

%CONFIGURACIÓN
\renewcommand{\contentsname}{Índice}
\renewcommand{\partname}{Experiencia}
\renewcommand{\listtablename}{Lista de Tablas}
\renewcommand{\listfigurename}{Lista de Figuras}
\renewcommand{\appendixpagename}{Anexos}
\renewcommand{\appendixtocname}{\large Anexos}
\renewcommand{\appendixname}{Anexo}
\renewcommand{\figurename}{Figura}
\renewcommand{\tablename}{Tabla}

\newcommand{\listecuacionesname}{\Large Lista de Ecuaciones}
\newlistof{ecuaciones}{equ}{\listecuacionesname}
\newcommand{\ecuaciones}[1]{\addcontentsline{equ}{ecuaciones}{\protect\numberline{\theequation}#1}\par}

\linespread{1.3}
\counterwithin*{section}{part}

\newcommand{\code}[1]{\texttt{#1}} %Formatear texto como código




%DOCUMENTO
\begin{document}
  \maketitle

  \tableofcontents

  \newpage
  \part*{Introducción}
  \addcontentsline{toc}{part}{Introducción}

  El objetivo de esta memoria es ofrecer un informe detallado de las prácticas de instrumentación, detallando las distintas experiencias llevadas a cabo con circuitos de \textbf{corriente continua} y \textbf{corriente alterna}.

  \section{Material}

  \subsection{Corriente Continua (Experiencia I)}

  \begin{itemize}[label=$-$]
    \item Polímetro
    \item Fuente de alimentación (CC)
    \item Resistencias de $180k\Omega$, $220k\Omega$, $390k\Omega$ y $1M\Omega$
    \item Tablero de conexiones
    \item Cables
  \end{itemize}

  \subsection{Corriente Alterna (Experiencia II)}
  \begin{itemize}[label=$-$]
    \item Osciloscopio
    \item Fuente de alimentación (CA, senosoidal)
    \item Resistencia de $10k\Omega$
    \item Condensador de $12nF$
    \item Tablero de conexiones
    \item Cables
  \end{itemize}


  \section{Tratamiento de datos}

  Para una correcta interpretación de los resultados expuestos en las próximas páginas, explicaremos las distintas metodologías y convenciones sobre el tratamiento de los datos de las mismas. En este apartado se incluyen la explicación de los métodos de \textbf{regresión lineal} y \textbf{propagación de incertidumbres}.

  \subsection{Reglas de redondeo}
  \label{sec:redondeo}

  En todas las mediciones expuestas utilizaremos los siguientes métodos de redondeo, aquellos convenidos en las jornadas de introducción:

  \begin{enumerate}
    \item Si la cifra en la posición n+1 es mayor que 5, la cifra n se incrementa en una unidad.
    \item Si la cifra en la posición n+1 es menor que 5, la cifra n se mantiene igual.
    \item Si la cifra en la posición n+1 es igual a 5, y alguna de las otras cifras suprimidas es distinta de 0, la cifra n se incrementa en una unidad.
    \item Si la cifra en la posición n+1 es igual a 5, y el resto de cifras suprimidas son iguales a 0, la cifra n se mantiene igual si es par y se incrementa en una unidad si es impar.
  \end{enumerate}

  \subsection{Incertidumbre de medidas directas}
  \label{sec:incert}

  En la práctica de corriente continua debemos indicar las incertidumbres de las mediciones realizadas. Como el polímetro utilizado es un aparato digital, consideraremos que una estimación de la incertidumbre sobre el valor real será la resolución ($\Delta x$) del mismo. Por lo tanto, tomaremos una unidad de la última cifra que muestre el aparato cómo $s_B (x)$.

  Como en estas medidas no existe otro tipo de incertidumbre a la que podamos aplicar un tratamiento estadístico, consideraremos $s_B (x)$ la incertidumbre final de la medida.

  \subsection{Múltiples medidas directas}

  Si realizamos una serie de medidas directas, la desviación típica de la media ($s_A (\bar{x})$) representa la incertidumbre de cualquier medida realizada con el mismo instrumento bajo las mismas condiciones. Con ambos datos podemos calcular la incertidumbre combinada:
  \begin{equation} \label{ec:scx}
    s_C (\bar{x}) = \sqrt{\left[ s_A (\bar{x}) \right]^2 + \left[ s_B (x) \right]^2}
  \end{equation}

  \subsection{Regresión lineal simple}
  \label{sec:reglin}

  Para ajustar los una serie de datos que parezcan seguir una relación lineal podemos utilizar el método de \textbf{ajuste por mínimos cuadrados}. Al ser \textit{lineal}, podemos ajustarla por una recta general de la forma $y = \alpha + \beta x$. El problema a resolver es conseguir la mejor aproximación \textit{a}, \textit{b} de los parámetros $\alpha, \beta$ y sus incertidumbres utilizando nuestra serie de parámetros $\left\{ x_i, y_i \right\}$.

  Para ello minimizaremos la suma de los productos del peso estadístico de cada punto, $w_i$, por el cuadrado de la desviación de los datos, $[y_i - (a + bx_i)]^2$. Por lo tanto, las derivadas parciales respecto a \textit{a} y \textit{b} deben de ser 0.
  \begin{equation} \label{ec:chi2}
    \chi^2 = \sum^{n}_{i=1} w_i[y_i - (a + bx_i)]^2
  \end{equation}
  \begin{equation} \label{ec:deriv}
    \frac{\partial \chi^2}{\partial a}=0, \frac{\partial \chi^2}{\partial b}=0
  \end{equation}

  De aquí resultan dos posibles casos:

  \begin{enumerate}
    \item Si las incertidumbres de $x_i$ no son despreciables respecto a las de $y_i$. Obtenemos la siguiente ecuación: $\omega_i=\frac{1}{s^2(y_i)+b^2s^2(x_i)}$, que excede el nivel de este curso.
    \item Si por el contrario podemos despreciar las incertidumbres de $x_i$ respecto a $y_i$, podemos simplificar la ecuación anterior a $\omega_i=[s(y_i)]^{-2}$.
  \end{enumerate}

  En nuestro caso, tanto en la estimación de una resistencia mediante la ley de Ohm como en el circuito en serie se pueden despreciar las incertidumbres. En ambos representaremos voltaje (V) frente a intensidad (I). La incertidumbre de la intensidad es del orden de $s(x_i)=10^{-7}$, mientras que la del voltaje es del orden de $s(y_i)=10^{-2}$, por lo que podremos aplicar el segundo método.

  Además, podemos considerar que las incertidumbres de $y_i$ permanecen constantes entre las diferentes medidas, por lo que también lo hará el peso estadístico $w = cte$. Podemos sustituír en la fórmula \ref{ec:chi2} y derivar respecto a \textit{a} y \textit{b} para obtener:
  \begin{gather}
    \chi^2 = w\sum^{n}_{i=1}[y_i - (a + bx_i)]^2 \nonumber \\
    a n + b\sum_{i}x_i = \sum_{i}y_i \quad \quad \sum_{i}x_i + b\sum_{i}x_i^2 = \sum_{i}x_i y_i \label{ec:dchi}
  \end{gather}

  Finalmente, conseguimos las expresiones matemáticas de \textit{a} y \textit{b} en base a la serie de medidas $\left\{ x_i, y_i \right\}$:
  \begin{gather}
    a = \frac{\left ( \sum_i y_i \right )\left ( \sum_i x_i^2 \right ) - \left ( \sum_i x_i \right )\left ( \sum_i x_i y_i \right )}{n\left ( \sum_i x_i^2 \right ) - \left ( \sum_i x_i \right )^2} \label{ec:a} \\
    b = \frac{n\left ( \sum_i x_i y_i \right ) - \left ( \sum_i x_i \right )\left ( \sum_i y_i \right )}{n\left ( \sum_i x_i^2 \right )-\left ( \sum_i x_i \right )^2} \label{ec:b}
  \end{gather}

  Además de los coeficientes para ajustar la recta, también podemos obtener otras magnitudes de interés sobre nuestra muestra:
  \begin{figure}[H]
    \begin{equation} \label{ec:s}
      s = \sqrt{\frac{\sum_i \left ( y_i - a - bx_i \right )^2}{1}}
    \end{equation}
    \caption{Desviación típica del ajuste para la muestra}
  \end{figure}
  \begin{figure}[H]
    \begin{equation} \label{ec:sab}
      s(a) = s\sqrt{\frac{\sum_i x_i^2}{n\left ( \sum_i x_i^2 \right ) - \left ( \sum_i x_i \right )^2}} \quad \quad s(b) = s\sqrt{\frac{n}{n\left ( \sum_i x_i^2 \right ) - \left ( \sum_i x_i \right )^2}}
    \end{equation}
    \caption{Incertidumbres de los parámetros \textit{a} y \textit{b}}
  \end{figure}
  \begin{figure}[H]
    \begin{equation} \label{ec:r}
      r = \frac{n\left ( \sum_i x_i y_i \right ) - \left ( \sum_i x_i \right )\left ( \sum_i y_i \right )}{\sqrt{\left [ n\left ( \sum_i x_i^2 \right ) - \left ( \sum_i x_i \right ) ^2\right ]\left [ n\left ( \sum_i y_i^2 \right ) - \left ( \sum_i y_i \right ) ^2 \right ]}}
    \end{equation}
    \caption{Coeficiente de regresión lineal}
  \end{figure}

  \subsection{Propagación de incertidumbres}
  \label{sec:propinc}

  Hay que hayar la incertidumbre correcta para aquellas medidas que sean indirectas (no se miden experimentalmente, si no que se aplican fórmulas a mediciones experimentales). Para ello empleamos el método de propagación de incertidumbres, que nos da la desviación estándar combinada:
  \begin{equation} \label{ec:propinc}
    s(y) = \sqrt{\sum_i\left ( \frac{\partial y}{\partial x_i} \right )^2 s^2(x_i)}
  \end{equation}

  Las magnitudes $x_i$ son aquellas medidas experimentalmente de las que depende la magnitud indirecta $y$. Todas las magnitudes $x_i$ han de ser independientes entre si.



  \newpage
  \part{Corriente Continua}

  \section{Objetivos}
  \begin{itemize}[label=$-$]
    \item Comprobar que el código de colores de las resistencias se corresponde con su valor real.
    \item Verificar el cumplimiento de la ley de Ohm ($V = I\cdot R$) en un circuito simple.
    \item Verificar las leyes de asociación de resistencias (ley de Kirchhoff) en circuitos en serie, paralelo y mixto.
    \item Perfeccionar el manejo del polímetro y demás utensilios del laboratorio.
  \end{itemize}

  \section{Medida de resistencias}
  El material de la práctica incluye cuatro resistencias. Para conocer sus valores utilizaremos dos métodos distintos, uno teórico y uno experimental, y luego contrastaremos los resultados.

  \subsection{Código de colores}
  Las resistencias tienen cuatro bandas de colores que indican su \textbf{valor nominal}. Estos colores se rigen por el siguiente código de resistencias estándar para cuatro bandas.

  \begin{figure}[H]
    \centering
    \begin{tabular}{|c|c|c|c|c|}
      \hline
      Color & 1º & 2º & Multiplicador & Tolerancia \\
      \hline
      \rowcolor{Black}
      \color{White} Negro & \color{White} 0 & \color{White} 0 & \color{White} 1$\Omega$ & \color{White} - \\
      \hline
      \rowcolor{Brown}
      Marrón & 1 & 1 & 10$\Omega$ & $\pm$1\% \\
      \hline
      \rowcolor{Red}
      Rojo & 2 & 2 & 100$\Omega$ & $\pm$2\% \\
      \hline
      \rowcolor{Orange}
      Naranja & 3 & 3 & 1k$\Omega$ & - \\
      \hline
      \rowcolor{Yellow}
      Amarillo & 4 & 4 & 10k$\Omega$ & - \\
      \hline
      \rowcolor{Green}
      Verde & 5 & 5 & 100k$\Omega$ & $\pm$0,5\% \\
      \hline
      \rowcolor{Blue}
      Azul & 6 & 6 & 1M$\Omega$ & $\pm$0,25\% \\
      \hline
      \rowcolor{Violet}
      Violeta & 7 & 7 & 10M$\Omega$ & $\pm$0,1\% \\
      \hline
      \rowcolor{Grey}
      Gris & 8 & 8 & 100M$\Omega$ & $\pm$0,05\% \\
      \hline
      \rowcolor{White}
      Blanco & 9 & 9 & 1G$\Omega$ & - \\
      \hline
      \rowcolor{Golden}
      Dorado & - & - & 0,1$\Omega$ & $\pm$5\% \\
      \hline
      \rowcolor{Silver}
      Plateado & - & - & 0,01$\Omega$ & $\pm$10\% \\
      \hline
    \end{tabular}
    \caption{Código de colores para resistencias}
  \end{figure}

  En base a esta tabla podemos calcular el valor teórico de la resistencia y su indeterminación (La tolerancia por el valor nominal). La primera banda indicará la primera cifra (A), la segunda banda será la segunda cifra (B), y la tercera banda la potencia de diez a la que está elevado ($C = 10^n$). Por lo tanto, el número resultante será de la forma $AB\cdot C$. La última banda representa la toleracia de acuerdo a la tabla anterior. Así tenemos los siguientes resultados, ordenados de menor a mayor.

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|c|c|,
    table head=\hline Resistencia & Color & V.~Nominal~($\Omega$) & Tolerancia~(\%) & s(R)~($\Omega$) \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CC51.csv}
    {r=\r, color=\rescolor, vn=\vn, t=\t, sr=\sr}
    {\r & \rescolor & \vn & \t & \sr}
  \caption{Medida del valor nominal de las resistencias}
  \label{tb:valnomres}
  \end{table}

  \subsection{Medida directa}
  \label{sec:medidaresist}
  Ahora utilizaremos el polímetro para determinar el valor experimental de cada resistencia y comprobar si se corresponde al valor teórico. Configuramos el polímetro para la medición de resistencias, y obtenemos los siguientes resultados:

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|c|,
    table head=\hline Resistencia & Lectura~($\Omega$) & Resolución~($\Omega$) & $R \pm s(R)~(\Omega)$ \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CC52.csv}
    {r=\r, lectura=\lectura, resolucion=\resolucion, sr=\sr}
    {\r & \lectura & \resolucion & \lectura \hspace{4pt}$\pm$ \sr}
  \caption{Medida del valor experimental de las resistencias}
  \label{tab:res}
  \end{table}

  Podemos observar que los resultados experimentales entran dentro del umbral de confianza del 5\% de los obtenidos teóricamente, por lo que asumiremos que son correctos.


  \newpage
  \section{Ley de Ohm}

  \subsection{Explicación teórica}
  Si tomamos un circuito eléctrico de corriente continua, podemos derivar la siguiente relación entre la diferencia de potencial del circuito (\textit{V}), la intensidad que circula por él (\textit{I}) y la resitencia eléctrica del material (\textit{R}). A esta relación la llamamos \textbf{Ley de Ohm}.
  \begin{equation} \label{ec:ohm}
    V = I \cdot R
  \end{equation}
  Siguiendo el sistema internacional (SI), \textit{V} se expresa en Voltios (\textit{V}), \textit{I} en Amperios (\textit{A}) y \textit{R} en Ohmios ($\Omega$).

  \subsection{Estimación indirecta}
  Ahora comprobaremos experimentalmente el cumplimiento de la Ley de Ohm. Para ello construiremos un circuito simple, utilizando una fuente de corriente continua y una resistencia ($R_1$: 180k$\Omega$). Lo dispondremos de la siguiente manera:

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,3) -- (3,3)
      to[R=$R_1$] (3,0) -- (0,0);
    \end{circuitikz}
    \caption{Circuito simple}
  \end{figure}

  Colocaremos el polímetro en dos posiciones: Para medir la intensidad, en serie; para medir el potencial, en paralelo alrededor de la resistencia. Podemos verlo en el diagrama mostrado a continuación.

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,3) -- (2,3)
      to[R=$R_1$] (2,0) -- (0,0);
      \draw (2,3) -- (4,3)
      to[voltmeter] (4,0) -- (2,0);
    \end{circuitikz}
    \quad \quad
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,3)
      to[ammeter](3,3)
      to[R=$R_1$] (3,0) -- (0,0);
    \end{circuitikz}
    \caption{Medición de potenciales y intensidades}
  \end{figure}

  Ahora configuramos la fuente de corriente continua para un voltaje $V_1$, y medimos con el polímetro primero el voltaje (Porque la medida de la fuente no siempre es fiable) y luego la intensidad asociada a ese voltaje, $I_1$. Realizamos sucesivas mediciones aumentando progresivamente el voltaje, y obtendremos unos datos, por ejemplo:

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|,
    table head=\hline Medida & $V \pm s(V)~(V)$ & $I \pm s(I)~(I)$ \\ \hline,
    late after last line=\\\hline,
    filter test=\ifnumless{\thecsvrow}{2},
    separator=semicolon
    ]{CC53.csv}
    {v=\v, sv=\sv, i=\int, si=\si}
    {\thecsvrow & \v \hspace{4pt}$\pm$ \sv & \int \hspace{4pt}$\pm$ \si}
  \caption{Ejemplo de las mediciones de voltaje e intensidad}
  \end{table}

  Sim embargo, nuestro objetivo es comprobar si se cumple la Ley de Ohm, y para eso debemos de calcular el valor de las resistencias de manera indirecta. Para eso utilizaremos la ecuación \ref{ec:ohm} y despejaremos para \textit{R}.
  \begin{equation*}
    R = \frac{V}{I}
  \end{equation*}
  Ahora debemos de calcular la incertidumbre de \textit{R}, \textit{s(R)}. Para ello utilizamos el método de propagación de incertidumbres descrito en la sección \ref{sec:propinc}, y utilizaremos la ecuación \ref{ec:propinc}. Tomaremos \textit{V} como $x_1$, \textit{I} como $x_2$ y \textit{R} como \textit{y}.
  \begin{gather}
    s(R)) = \sqrt{\left(\frac{\partial R}{\partial V}\right)^2 s^2(V) + \left(\frac{\partial R}{\partial I}\right)^2 s^2(I)} \quad \quad
    \frac{\partial R}{\partial V} = \frac{1}{I} \quad \quad
    \frac{\partial R}{\partial I} = -\frac{V}{I^2} \nonumber \\
    s(R) = \sqrt{\left(\frac{1}{I}\right)^2 s^2(V) + \left(-\frac{V}{I^2}\right)^2 s^2(I)} \label{ec:propincohm}
  \end{gather}
  Aplicamos la fórmula anterior para calcular las incertidumbres de \textit{R}. Redondeamos \textit{s(R)} para que tenga dos cifras significativas (\textit{Por ejemplo: De 2641 a $2,6 \cdot 10^3$}) y ajustamos \textit{R} para que su última cifra significativa coincida con la posición decimal de la última cifra significativa de \textit{s(R)}. (\textit{Por ejemplo: con s(R) = $2,6 \cdot 10^3$, R se redondearía a las centenas ($10^2$)}). Utilizamos las técnicas de redondeo del apartado \ref{sec:redondeo}.

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|c|,
    table head=\hline Medida & $V \pm s(V)~(V)$ & $I \pm s(I)~(I)$ & $R \pm s(R)~(\Omega)$ \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CC53.csv}
    {v=\v, sv=\sv, i=\int, si=\si, r=\r, sr=\sr}
    {\thecsvrow & \v \hspace{4pt}$\pm$ \sv & \int \hspace{4pt}$\pm$ \si & \r \hspace{4pt}$\pm$ \sr}
  \caption{Potenciales e intensidades de un circuito simple con la resistencia $R_1$}
  \label{tb:ohm}
  \end{table}

  Podemos observar que el valor de \textit{R} es prácticamente constante para cualquier combinación de voltajes e intensidades que escojamos. Además, se adecua mucho al valor experimental que obtuvimos en el apartado \ref{sec:medidaresist} ($1,755 \cdot 10^5 \pm 10^2 \Omega$), por lo que podemos concluir que se cumple la \textbf{Ley de Ohm}.

  \subsection{Representación gráfica de V frente a I}

  Hagamos ahora una representación gráfica de los valores del potencial (\textit{V}) frente a los de la intensidad (\textit{I}). Para hacer la gráfica utilizaremos el paquete \code{matplotlib} y para cargar los datos desde un .csv en el que tabulamos los datos (que también usamos para generar las tablas en \LaTeX) añadiremos \code{pandas} (una extensión de \code{numpy}).

  \begin{python}
    import matplotlib.pyplot as plt
    import pandas as pd

    d = pd.read_csv(name + ".csv", sep=';', decimal=',')
    x = d["i"] ; y = d["v"]
    n = d.shape[0]

    plt.scatter(x * (10**6), y)
    plt.xlabel('I($\mu$A)')
    plt.ylabel('V(V)', rotation=0, labelpad=20)
  \end{python}

  Vamos a crear una gráfica \textit{scatter} (de dispersión) para no unir los puntos de manera automática, ya que los valores medidos en el laboratorio son discretos. También cambiaremos la escala del eje x a $\mu$A para una leyenda más compacta. La exportamos a .pgf para poder cargarla en \LaTeX\  sin pérdida de calidad, y la representamos a continuación:

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC53NoReg.pgf}
    \caption{Voltaje (V) frente a intensidad (I)}
  \end{figure}

  \subsection{Ajuste por mínimos cuadrados}
  \label{sec:ajusteminres}

  Como podemos observar, parece que existe una relación lineal entre las dos magnitudes. Procedemos entonces a hacer un ajuste de regresión lineal por mínimos cuadrados. Como explicamos en la sección \ref{sec:reglin}, tenemos que calcular los coeficientes \textit{a} y \textit{b} de la recta $a + bx$. Para ello utilizamos las ecuaciones \ref{ec:a} y \ref{ec:b}. Como vemos, hay que calcular los siguientes términos:
  \begin{gather}
    \sum_i x_i \nonumber \qquad \sum_i y_i \nonumber \qquad \sum_i x_iy_i \nonumber \qquad \sum_i x_i^2 \nonumber
  \end{gather}

  Para ello, utilizaremos la tabla en .csv en la que tenemos los datos, y la cargaremos en python. Ahora definiremos una función \code{reg\_lin()} que calcule estas sumas a partir de las columnas de nuestra tabla y las almacene en variables separadas. Posteriormente, aplicaremos las fórmulas \ref{ec:a} y \ref{ec:b} y calcularemos así los términos \textit{a} y \textit{b}. Tenemos que decir que en estos casos, el término \textit{a} tiene que aproximarse mucho a 0 para ser despreciables, ya que sabemos que la recta tiene que pasar por el origen. Calcularemos \textit{a} para comprobar que es pequeño y que no influye en el ajuste. Al final será cómo sumar "0" en la fórmula $y = a + bx$.

  \begin{python}
    def reg_lin(x, y, n):
        sx = x.sum()
        sy = y.sum()
        sxy = (x*y).sum()
        sx2 = (x**2).sum()

        a = (sy*sx2 - sx*sxy) / (n*sx2 - sx**2)
        b = (n*sxy - sx*sy) / (n*sx2 - sx**2)

        sy2 = (y**2).sum()
        r = (n*sxy - sx*sy)/(((n*sx2 - sx**2)*(n*sy2 - sy**2))**0.5)

        return a, b, r

    a, b, r = reg_lin(x, y, n)
  \end{python}

  El comando \code{.sum()} de la tabla de cargamos en \code{pandas} simplemente suma todos los términos de la columna que especificamos. En este caso, tomamos la columna x como la intensidad (\textit{I}) y la columna y como el potencial (\textit{V}) de la tabla \ref{tb:ohm}, que cargamos directamente en \code{python}. También podemos realizar operaciones con las columnas antes de sumar sus términos, como multiplicar una por otra o elevar sus términos al cuadrado. Así podemos crear los sumatorios necesarios para resolver las fórmulas de a y b. Obtenemos los siguientes resultados:
  \begin{gather}
    \sum_i x_i = 3,18\cdot10^{-4} \nonumber \qquad \sum_i y_i = 56,0 \nonumber \qquad \sum_i x_iy_i = 2,25\cdot10^{-3} \nonumber \qquad \sum_i x_i^2 = 1,28\cdot10^{-8} \nonumber \\
    a = 9,19\cdot10^{-3} \nonumber \qquad b = 1,75 \cdot 10^5 \label{v:ohm}
  \end{gather}
  Podemos utilizar ahora estos valores para crear la gráfica con la recta que mejor se ajuste a los datos, creando una función \code{plot()} que permita crear gráficas con y sin regresión lineal:

  \begin{python}
    def plot(x, y, n, reg, cc, cr):
      if reg:
          a, b, r = reg_lin(x, y, n)
          xr = np.linspace(min(x) * (10**6), max(x) * (10**6), 10)
          yr = a + ((b*xr) / (10**6))
          plt.plot(xr, yr, color=cr, zorder=1)
      plt.scatter(x * (10**6), y, color=cc, zorder=2)

    plot(x, y, n, True, "color1", "color2")
  \end{python}

  Y, ahora sí, podemos ver nuestra gráfica completa.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC53.pgf}
    \caption{Voltaje (V) frente a intensidad (I) con regresión lineal}
  \end{figure}

  A simple vista se puede observar que el ajuste es razonablemente preciso. Sin embargo, podemos obtener una medida fiable de cúan preciso es. Para ello utilizamos el coeficiente de regresión lineal (Ecuación \ref{ec:r}). En este caso, obtenemos que es $r = 0.999997$, un ajuste con cinco nueves, lo cual muestra una precision notable.

  Una propiedad interesante de esta gráfica se puede derivar de la Ley de Ohm \ref{ec:ohm}. Si despejamos \textit{R} en función de \textit{I} y \textit{V}, obtenemos $R = \frac{V}{I}$. De esto se puede deducir que la pendiente de la gráfica ($\frac{\Delta V}{\Delta I}$) será constante e igual a la resistencia. Este término no es otro que nuestra constante de regresión lineal $b = 1,75 \cdot 10^5$. Si nos fijamos, es prácticamente igual al valor experimental que obtuvimos al medir las resistencias (\ref{tab:res}) y del que conseguimos al aplicar la Ley de Ohm (\ref{tb:ohm}).


  \newpage
  \section{Circuito en Serie}

  La siguiente experiencia consiste en crear un circuito con tres resistencias ($R_1$, $R_2$ y $R_3$) en serie con el objetivo de medir la instensidad del circuito, y el potencial total y en cada resistencia. Para ello colocaremos los componentes de la siguiente manera:

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,3)
      to[R=$R_1$] (3,3)
      to[R=$R_2$] (3,0)
      to[R=$R_3$] (0,0);
    \end{circuitikz}
    \caption{Circuito con tres resistencias en serie}
    \label{circuito:serie}
  \end{figure}

  \subsection{Procedimiento de medición}

  Para medir las diferentes magnitudes, colocaremos el polímetro en serie para las intensidades y en paralelo para los voltajes.

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,2)
      to[R=$R_1$] (2,2)
      to[R=$R_2$] (2,0)
      to[R=$R_3$] (0,0);
      \draw (0,2) -- (0,3.5)
      to[voltmeter, l=$V_1$] (2,3.5) -- (2,2);
    \end{circuitikz}
    \raisebox{0.28in}{
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,2)
      to[R=$R_1$] (2,2)
      to[R=$R_2$] (2,0)
      to[R=$R_3$] (0,0);
      \draw (2,2) -- (3.5,2)
      to[voltmeter, l=$V_2$] (3.5,0) -- (2,0);
    \end{circuitikz}}
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,2)
      to[R=$R_1$] (2,2)
      to[R=$R_2$] (2,0)
      to[R=$R_3$] (0,0);
      \draw (2,2) -- (2,-1.5)
      to[voltmeter, l=$V_3$] (0,-1.5) -- (0,0);
    \end{circuitikz}
    \caption{Medición de potenciales de $R_1$, $R_2$ y $R_3$ respectivamente}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,2)
      to[R=$R_1$] (2,2)
      to[R=$R_2$] (4,2) -- (4,0)
      to[R=$R_3$] (2,0)
      to[ammeter, l=$I$] (0,0);
    \end{circuitikz}
    \caption{Medición de la intensidad total del circuito}
  \end{figure}

  \subsection{Resistencia equivalente}
  \label{sec:reseqserie}

  Primero debemos de averiguar cual es la resistencia equivalente de todo el circuito. Para ello utilizamos la siguiente fórmula, que se aplica a resistencias en serie:
  \begin{equation} \label{ec:reseq}
    R_S = \sum_{k=1}^N R_k \qquad R = R_1 + R_2 + R_3
  \end{equation}
  De aquí podemos deducir que la diferencia de potencial para cada resistencia será distinta, y que su suma ha de resultar en la total del circuito, y que la intensidad será la misma para todas las resistencias (\textbf{Leyes de Kirchhoff}) En este caso:
  \begin{gather}
    V = \sum_{k=1}^N V_k \qquad V = V_1 + V_2 + V_3 \nonumber \\
    I = I_k \qquad I = I_1 = I_2 = I_3 \label{ec:kriser}
  \end{gather}
  Por lo tanto, calculamos la resistencia equivalente del circuito aplicando la fórmula \ref{ec:reseq} y propagación de incertidumbres (\ref{ec:propinc}):
  \begin{gather}
    R_S = 175500 + 216000 + 394000 = 7,855 \cdot 10^5 \Omega \nonumber \\
    s(R_S) = \sqrt{\left ( \frac{\partial R_S}{\partial R_1} \right )^2 s^2(R_1) + \left ( \frac{\partial R_S}{\partial R_2} \right )^2 s^2(R_2) + \left ( \frac{\partial R_S}{\partial R_3} \right )^2 s^2(R_3)} \nonumber \\ s(R_S) = s(R_1) + s(R_2) + s(R_3) = \pm(100 + 1000 + 1000) = \pm2100 \Omega \nonumber \\ R_S = 7,855 \cdot 10^5 \pm 2,1 \cdot 10^3 \Omega \nonumber
  \end{gather}

  Si medimos experimentalmente el valor de la resistencia total del cirtuito obtenemos un valor $R_E = 7,89 \cdot 10^5 \pm 10^3$. No entra por completo dentro de nuestro intervalo de confianza ($R_T + 2,1 \cdot 10^3 = 7,876 \cdot 10^5$ y $R_E - 10^3 = 7,88 \cdot 10^5$), pero queda razonablemente cerca, difieren en una cantidad del orden de $10^2$, por lo que podemos considerar que se debe a condiciones del experimento (Humedad, temperatura...).

  \subsection{Medición experimental}

  Siguiendo el procedimiento anterior, realizamos una serie de medidas en el circuito \ref{circuito:serie}. Iremos variando el potencial (\textit{V}) de la fuente y anotando los cambios del resto de magnitudes. Como especificamos en el apartado \ref{sec:incert} tomaremos la resolución de la medida como su incertidumbre.

  \begin{table}[H]
  \centering
  \resizebox{\columnwidth}{!}{
  \csvreader[
    tabular=|c|c|c|c|c|c|,
    table head=\hline Medida & $V~(V) \pm s(V)$ & $V_1~(V) \pm s(V_1)$ & $V_2~(V) \pm s(V_2)$ & $V_3~(V) \pm s(V_3)$ & $I~(A) \pm s(I)$ \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CC6.csv}
    {v=\v, v1=\va, v2=\vb, v3=\vc, i=\int, sv=\sv, sv1=\sva, sv2=\svb, sv3=\svc, si=\si}
    {\thecsvrow & \v \hspace{4pt}$\pm$ \sv & \va \hspace{4pt}$\pm$ \sva & \vb \hspace{4pt}$\pm$ \svb & \vc \hspace{4pt}$\pm$ \svc & \int \hspace{4pt}$\pm$ \si}
  }
  \caption{Potenciales e intensidades del circuito en serie}
  \end{table}

  \subsection{Representación gráfica de V frente a I}

  Utilizaremos el mismo programa de \code{python} que en el apartado anterior para representar nuestro voltaje (\textit{V}) frente a la intensidad (\textit{I}).

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC6NoReg.pgf}
    \caption{Voltaje (V) frente a intensidad (I)}
  \end{figure}

  También podemos comparar la diferencia entre los potenciales de las distintas resistencias en serie añadiendo las gráficas de $V_1$, $V_2$ y $V_3$ frente a I.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC6NoRegMulti.pgf}
    \caption{Voltajes (\textcolor{Blue}{$V$}, \textcolor{Red}{$V_1$}, \textcolor{Yellow}{$V_2$}, \textcolor{Green}{$V_3$}) frente a intensidad (I)}
  \end{figure}

  \subsection{Ajuste por mínimos cuadrados}
  \label{sec:ajusteminimoscuadradosserie}

  Vuelve a aparecer lo que parece una relación lineal en la gráfica, por lo que pasaremos a hacer un ajuste por mínimos cuadrados. Cómo explicamos en el apartado inicial \ref{sec:reglin} y cómo ya aplicamos en la sección anterior, \ref{sec:ajusteminres}, calcularemos los parámetros \textit{a} y \textit{b} utilizando las ecuaciones \ref{ec:a} y \ref{ec:b}, para ello calculando diversos sumatorios utilizando el programa de \code{python} que describimos, cargando la tabla en .csv con nuestros datos y aplicando las fórmulas de los sumatorias, con lo que obtenemos los siguientes resultados:
  \begin{gather}
    \sum_i x_i = 6,98\cdot10^{-5} \nonumber \qquad \sum_i y_i = 55,6 \nonumber \qquad \sum_i x_iy_i = 4,93\cdot10^{-4} \nonumber \qquad \sum_i x_i^2 = 6,20\cdot10^{-10} \nonumber \\
    a = 4,71\cdot10^{-2} \nonumber \qquad b = 790000 \label{v:serie}
  \end{gather}
  El proceso sería el mismo para obtener los datos de las rectas de $V_1$, $V_2$ y $V_3$. Finalmente podríamos dibujar las gráficas, ahora con una recta creada por regresión lineal que se ajusta a los datos que obtuvimos.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC6.pgf}
    \caption{Voltajes (\textcolor{Blue}{$V$}, \textcolor{Red}{$V_1$}, \textcolor{Yellow}{$V_2$}, \textcolor{Green}{$V_3$}) frente a intensidad (I) con regresión lineal}
  \end{figure}

  En cuanto a los coeficientes de regresión lineal, calculados con la fórmula \ref{ec:r}, de nuevo obtenemos resultados satisfactorios: $r = 0,99997$, $r_1 = 0,99998$, $r_2 = 0,99997$ y $r_3 = 0,99997$, un ajuste de cuatro nueves en ambos casos.

  También podemos comprobar si el valor de la resistencia equivalente calculado en \ref{sec:reseqserie} ($R_S = 7,855 \cdot 10^5$) se corresponde con la pendiente de la gráfica ($b = 7,90 \cdot 10^5$), y podemos ver que se adecuan. Pasa lo mismo si tomamos cualquiera de las otras rectas con respecto a $V_1$, $V_2$ y $V_3$, cada una tiene una pendiente similar a la resistencia de ese tramo. Se puede observar a simple vista viendo que la recta roja corresponde a $R_1$, la resistencia más pequeña, y también la que menor pendiente tiene, mientras que la recta verde es de $R_3$, la más grande y la de mayor pendiente. La recta azul tiene más pendiente que todas ya que es la suma de las tres resistencias en serie.


  \newpage
  \section{Circuito en Paralelo}

  En este apartado construiremos un circuito utilizando tres resistencias ($R_1$, $R_2$ y $R_3$) colocadas en paralelo. Ahora mediremos la intensidad en cada resistencia y total, además del voltaje del circuito. Colocamos los componentes siguiendo el diagrama:

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,3) -- (3.25,3)
      to[R=$R_2$] (3.25,0) -- (0,0);
      \draw (3.25, 2.75) -- (2, 2.75)
      to[R=$R_1$] (2, 0.25) -- (4, 0.25);
      \draw (3.25, 2.75) -- (4.5, 2.75)
      to[R=$R_3$] (4.5, 0.25) -- (4, 0.25);
    \end{circuitikz}
    \caption{Circuito con tres resistencias en paralelo}
    \label{circuito:paralelo}
  \end{figure}

  \subsection{Procedimiento de medición}

  Con el objetivo de medir las distintas magnitudes, conectaremos el polímetro en serie para las itensidades y en paralelo para los voltajes.

  \begin{figure}[H]
    \centering
    \raisebox{0.53in}{
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,3) -- (3.25,3)
      to[R=$R_2$] (3.25,0) -- (0,0);
      \draw (3.25, 2.75) -- (2, 2.75)
      to[R=$R_1$] (2, 0.25) -- (4, 0.25);
      \draw (3.25, 2.75) -- (4.5, 2.75)
      to[R=$R_3$] (4.5, 0.25) -- (4, 0.25);
      \draw (3.25, 3) -- (6.5, 3)
      to[voltmeter, l_=$V$] (6.5, 0) -- (3.25, 0);
    \end{circuitikz}} \qquad
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,5) -- (4.5,5) -- (4.5, 4.75)
      to[R=$R_2$] (4.5, 2.25) to[ammeter, l=$I_2$] (4.5,0.25) -- (4.5, 0) -- (3, 0)
      to[ammeter, l_=$I$] (0,0);
      \draw (4.5, 4.75) -- (3, 4.75)
      to[R=$R_1$] (3, 2.25) to[ammeter, l=$I_1$] (3, 0.25) -- (4.5, 0.25);
      \draw (4.5, 4.75) -- (6, 4.75)
      to[R=$R_3$] (6, 2.25) to[ammeter, l=$I_3$] (6, 0.25) -- (4.5, 0.25);
    \end{circuitikz}
    \caption{Medición de potencial del circuito ($V$) y de intensidades, total ($I$) y de cada resistencia ($I_1$, $I_2$ y $I_3$ respectivamente)}
  \end{figure}

  \subsection{Resistencia equivalente}
  \label{sec:reseqparalelo}

  Calculemos la resistencia equivalente al circuito aplicando la fórmula para resistencias en paralelo:
  \begin{equation}
      \label{ec:resparalelo}
      \frac{1}{R_P} = \sum^N_{k=1} \frac{1}{R_k} \qquad \frac{1}{R_P} = \frac{1}{R_1} + \frac{1}{R_2} + \frac{1}{R_3}
  \end{equation}
  Además de esto sabemos que la intensidad total del circuito se distribuirá entre las tres resistencias, mientras que el potencial permanecerá constante (\textbf{Leyes de Kirchhoff}), verificándose que:
  \begin{gather}
      I = \sum^N_{k=1} I_k \qquad I = I_1 + I_2 + I_3 \nonumber \\
      V = V_k \qquad V = V_1 = V_2 = V_3 \label{ec:kripar}
  \end{gather}
  Con esta información podemos calcular la resistencia equivalente al circuito aplicando la fórmula \ref{ec:resparalelo}:
  \begin{gather}
      \frac{1}{R_P} = \frac{1}{175500} + \frac{1}{216000} + \frac{1}{394000} \qquad R_P = \frac{1}{\frac{1}{175500} + \frac{1}{216000} + \frac{1}{394000}} = 7,773 \cdot 10^4 \Omega \nonumber \\
      s(R_P) = \sqrt{\left ( \frac{\partial R_P}{\partial R_1} \right )^2 s^2(R_1) + \left ( \frac{\partial R_P}{\partial R_2} \right )^2 s^2(R_2) + \left ( \frac{\partial R_P}{\partial R_3} \right )^2 s^2(R_3)} \nonumber \\
      \frac{\partial R_P}{\partial R_1} = \left ( \frac{R_2^2 R_3^2}{(R_1(R_2+R_3) + R_2R_3)^2} \right )^2
      s(R_P) = \pm1,4\cdot10^2 \Omega \nonumber \\
      R_P = 7,773 \cdot 10^4 \pm1,4\cdot10^2 \Omega \nonumber
  \end{gather}

  Si tomamos el valor de la resistencia total del circuito de manera experimental obenemos un valor de $R_E = 7,8 \cdot 10^4 \pm 10^3$. En este caso si que entra dentro de nuestro intervalo de confianza, por lo que consideramos que el cálculo teórico es correcto.

  \subsection{Medición experimental}

  Utilizando el procedimiento descrito con anterioridad, realizamos una serie de mediciones en el circuito \ref{circuito:paralelo}. Variaremos el voltaje para obtener diferentes medidas de los voltajes (\textit{V}) e intensidades (\textit{I}). El resultado se expone en la siguiente tabla (Por cuestiones de presentación se omitirá $\pm s(I)$ en las columnas correspondientes, ya que quedaría redundante y sólo dificultaría la lectura sin aportar información. $s(I) = s(I_1) = s(I_2) = s(I_3) = 1 \cdot 10^-7 A$):

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|c|c|c|,
    table head=\hline Medida & $V~(V) \pm s(V)$ & $I_1~(V)$ & $I_2~(V)$ & $I_3~(V)$ & $I~(A)$ \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CC7.csv}
    {v=\v, i1=\ia, i2=\ib, i3=\ic, i=\int, sv=\sv}
    {\thecsvrow & \v \hspace{4pt}$\pm$ \sv & \ia & \ib & \ic & \int }
  \caption{Potenciales e intensidades del circuito en paralelo}
  \end{table}

  \subsection{Representación gráfica de V frente a I}

  Cargamos estos datos en nuestro programa de \code{python} y representamos la gráfica correspondiente.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC7NoReg.pgf}
    \caption{Voltaje (V) frente a intensidad (I)}
  \end{figure}

  Así mismo, también podemos comparar la diferencia de las intensidades para un potencial fijo en cada resistencia en paralelo, añadiendo a la anterior las gráficas de \textit{V} frente a $I_1$, $I_2$ e $I_3$.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC7NoRegMulti.pgf}
    \caption{Voltajes (V) frente a intensidades (\textcolor{Blue}{$I$}, \textcolor{Red}{$I_1$}, \textcolor{Yellow}{$I_2$}, \textcolor{Green}{$I_3$})}
  \end{figure}

  \subsection{Ajuste por mínimos cuadrados}
  \label{v:paralelo}

  De nuevo parece que nos encontramos ante una relación lineal de las magnitudes, por lo que aplicaremos los métodos que ya describimos (\ref{sec:reglin}) para ajustar las rectas y representarlas gráficamente. Para la intensidad total (I), los parámetros son $a = -2,84 \cdot 10^-3$ y $b~=~78300$. El resto se pueden calcular análogamente con las fórmulas \ref{ec:a} y \ref{ec:b}.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC7.pgf}
    \caption{Voltajes (V) frente a intensidades (\textcolor{Blue}{$I$}, \textcolor{Red}{$I_1$}, \textcolor{Yellow}{$I_2$}, \textcolor{Green}{$I_3$}) con regresión lineal}
  \end{figure}

  Calculamos los coeficientes de regresión lineal con la fórmula \ref{ec:r} y los resultados son adecuados: $r = 0,999992$, $r_1 = 0,999997$, $r_2 = 0,999998$ y $r_3 = 0,99997$. Excepto $r_3$, los resultados tienen un ajuste excelente de cinco nueves. En el caso de $r_3$ son cuatro nueves, lo cual también es satisfactorio.

  Comprobamos también si el valor de la resistencia equivalente calculado en \ref{sec:reseqparalelo} ($R_P = 7,7726 \cdot 10^4$) se corresponde con la pendiente de la gráfica ($b = 7,83 \cdot 10^4$), y vemos que son muy similares.


  \newpage
  \section{Circuito Mixto}

  La última práctica de corriente continua comprende la construcción de un circuito mixto utilizando las cuatro resistencias ($R_1$, $R_2$, $R_3$ y $R_4$). Colocaremos $R_2$ y $R_3$ en paralelo entre sí, en un grupo llamado $R_{23}$, y luego conectaremos en serie $R_1$, $R_{23}$ y $R_4$. Podemos ver la disposición en el siguiente diagrama:

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,4)
      to[R=$R_1$] (4,4) -- (4,3.5);
      \draw (4,0.5) -- (4,0)
      to[R=$R_4$] (0,0);
      \draw (4,3.5) -- (3.25,3.5)
      to[R=$R_2$] (3.25,0.5) -- (4,0.5);
      \draw (4,3.5) -- (4.75,3.5)
      to[R=$R_3$] (4.75,0.5) -- (4,0.5);
    \end{circuitikz}
    \caption{Circuito mixto}
    \label{circuito:mixto}
  \end{figure}

  \subsection{Procedimiento de medición}

  Para medir los diferentes valores que se piden, tenemos que utilizar ambas técnicas que aprendimos en los circuitos anteriores. Primero, trataremos a las dos resistencias $R_2$ y $R_3$ como un circuito aislado en paralelo, y así determinaremos su voltaje total ($V_{23}$) y cada una de sus intensidades ($I_1$ y $I_2$).

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,4)
      to[R=$R_1$] (4,4) -- (4,3.5);
      \draw (4,0.5) -- (4,0)
      to[R=$R_4$] (0,0);
      \draw (4,3.5) -- (3.25,3.5)
      to[R=$R_2$] (3.25,0.5) -- (4,0.5);
      \draw (4,3.5) -- (4.75,3.5)
      to[R=$R_3$] (4.75,0.5) -- (4,0.5);
      \draw (4,4) -- (6.5,4)
      to[voltmeter, label=$V_{23}$] (6.5,0) -- (4,0);
    \end{circuitikz} \qquad
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source] (0,4)
      to[R=$R_1$] (4,4) -- (4,3.5);
      \draw (4,0.5) -- (4,0)
      to[R=$R_4$] (0,0);
      \draw (4,3.5) -- (3.25,3.5)
      to[R=$R_2$] (3.25,2.25)
      to[ammeter, label=$I_1$] (3.25,0.5) -- (4,0.5);
      \draw (4,3.5) -- (4.75,3.5)
      to[R=$R_3$] (4.75,2.25)
      to[ammeter, label=$I_2$] (4.75,0.5) -- (4,0.5);
    \end{circuitikz}
    \caption{Medición de potencial ($V_{23}$) y intensidades ($I_1$ y $I_2$) de las resistencias $R_2$ y $R_3$ en paralelo dentro del circuito mixto}
  \end{figure}

  Ahora que tenemos esos datos, trataremos a la unión de las resistencias $R_2$ y $R_3$ como un componente más de un circuito en serie, en conjunto con las otras resistencias, $R_1$ y $R_4$. Mediremos los voltajes de estas últimas resitencias en paralelo ($V_1$ y $V_4$). Luego tomaremos el voltaje de todo el circuito también en paralelo ($V$) y la intensidad del mismo, en serie ($I$).

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[ammeter,label=$I$] (0,2) to[voltage source] (0,4)
      to[R=$R_1$] (4,4) -- (4,3.5);
      \draw (4,0.5) -- (4,0)
      to[R, l_=$R_4$] (0,0);
      \draw (4,3.5) -- (3.25,3.5)
      to[R=$R_2$] (3.25,0.5) -- (4,0.5);
      \draw (4,3.5) -- (4.75,3.5)
      to[R=$R_3$] (4.75,0.5) -- (4,0.5);
      \draw (0,4) -- (0,5.5)
      to[voltmeter,label=$V_1$] (4,5.5) -- (4,4);
      \draw (0,0) -- (0,-1.5)
      to[voltmeter, label=$V_4$] (4,-1.5) -- (4,0);
      \draw (0,0) -- (-1.5,0)
      to[voltmeter, label=$V$] (-1.5,4) -- (0,4);
    \end{circuitikz}
    \caption{Medición de potenciales ($V_1$ y $V_4$) de las resistencias $R_1$ y $R_4$ en serie y del pontencial ($V$) e intensidad ($I$) total del circuito mixto}
  \end{figure}

  \subsection{Reistencia equivalente}
  \label{sec:reseqmixto}

  Para calcular la resistencia equivalente del circuito, primero utilizaremos la ecuación \ref{ec:resparalelo} para calcular la de las dos resistencias en paralelo $R_2$ y $R_3$, a la que llamaremos $R_{23}$. Posteriormente, aplicamos la ecuación \ref{ec:reseq} a $R_1$, $R_{23}$ y $R_4$, que están en serie. Así obtenemos la reistencia total.
  \begin{gather}
    R_{23} = \frac{1}{\frac{1}{216000} + \frac{1}{394000}} = 1,3951\cdot10^5\Omega \nonumber \\
    s(R_{23}) = \sqrt{\left ( \frac{\partial R_{23}}{\partial R_2} \right )^2 s^2(R_2) + \left ( \frac{\partial R_{23}}{\partial R_3} \right )^2 s^2(R_3)} \nonumber \\
    s(R_{23}) = \sqrt{\left ( \frac{R_3^2}{(R_2+R_3)^2} \right )^2 s^2(R_2) + \left ( \frac{R_2^2}{(R_2+R_3)^2} \right )^2 s^2(R_3)} = \pm 4,4\cdot 10^2\Omega \nonumber \\
    R = 175500 + 139510 + 1006000 = 1,3211\cdot10^6\Omega \nonumber \quad s(R) = 100 + 440 + 1000 = 1,54\cdot 10^3\Omega \nonumber \\
    R = 1,3210\cdot10^6 \pm 1,54\cdot 10^3\Omega
  \end{gather}

  Si calculamos experimentalmente el valor de la resistencia total del circuito obtenemos $R_E = 1,324 \cdot 10^6 \pm 10^3$, lo cual entra en nuestro intervalo de confianza, así que consideraremos ambas medidas correctas.

  \subsection{Medición experimental}

  Construímos el circuito \ref{circuito:mixto} y tomamos las medidas descritas con anterioridad. Variaremos el voltaje (V) desde la fuente de alimentación para obtener distintos valores a medir. Exponemos el resultado en la siguiente tabla dónde, como en la sección anterior, omitiremos las incertidubres de las intensidades ($s(I)$) por ser todas iguales $s(I) = s(I_1) = s(I_2) = 1 \cdot 10^-7 A$, con el objetivo de hacer la tabla más compacta.

  \begin{table}[H]
  \centering
  \resizebox{\columnwidth}{!}{
  \csvreader[
    tabular=|c|c|c|c|c|c|c|c|,
    table head=\hline Medida & $V~(V) \pm s(V)$ & $V_1~(V) \pm s(V_1)$ & $V_{s3}~(V) \pm s(V_{23})$ & $V_4~(V) \pm s(V_4)$ & $I_1~(V)$ & $I_2~(V)$ & $I~(A)$ \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CC8.csv}
    {v=\v, sv=\sv, v1=\va, sv1=\sva, v23=\vb, sv23=\svb, v4=\vc, sv4=\svc, i1=\ia, i2=\ib, i=\int}
    {\thecsvrow & \v \hspace{4pt}$\pm$ \sv & \va \hspace{4pt}$\pm$ \sva & \vb \hspace{4pt}$\pm$ \svb & \vc \hspace{4pt}$\pm$ \svc & \ia & \ib & \int }}
  \caption{Potenciales e intensidades del circuito mixto}
  \end{table}

  \subsection{Representación gráfica de V frente a I}

  Cargamos los datos de la tabla anterior en el programa de \code{python} para obtener la representación de la gráfica del voltaje total (V) frente a la intensidad total (I).

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC8NoReg.pgf}
    \caption{Voltaje (V) frente a intensidad (I)}
    \label{graf:cmixinttotal}
  \end{figure}

  También podemos probar a hacer gráficas más interesantes. Aquí no hay una relación tan clara como en los anteriores ejemplos, ya que existen varias magnitudes tanto en el eje x (I) como en el eje y (V). Podríamos probar a representar los diferentes valores de V ($V$, $V_1$, $V_{23}$ y $V_4$) frente a la intensidad total ($I$), como en la primera gráfica. También podemos hacer lo contrario, y representar el potencial total ($V$) frente a distintas intensidades ($I$, $I_1$ e $I_2$), como en la segunda gráfica. Como curiosidad más que como experimento, podemos mezclar ambas gráficas, y representar todas las combinaciones entre \textcolor{Blue}{$V$},~\textcolor{Red}{$V_1$},~\textcolor{Yellow}{$V_{23}$},~\textcolor{Green}{$V_4$} (\textit{color}) y \textcolor{Black}{$I$},~\textcolor{DarkGrey}{$I_1$},~\textcolor{Grey}{$I_2$} (\textit{luminosidad}).

  \begin{figure}[H]
    \centering
    \input{CC8NoRegVMultMini.pgf}
    \input{CC8NoRegIMultMini.pgf}
    \input{CC8NoRegMultMini.pgf}
    \caption{Voltajes (\textcolor{Blue}{$V$}, \textcolor{Red}{$V_1$}, \textcolor{Yellow}{$V_{23}$}, \textcolor{Green}{$V_4$}) frente a intensidades (\textcolor{Black}{$I$}, \textcolor{DarkGrey}{$I_1$}, \textcolor{Grey}{$I_2$})}
    \label{graf:cmixmulti}
  \end{figure}

  \subsection{Ajuste por mínimos cuadrados}
  \label{v:mixto}

  Procedemos a aplicar el método de regresión lineal con el ajuste por mínimos cuadrados (\ref{sec:reglin}). Ajustamos las rectas y las representamos gráficamente. Para la gráfica \ref{graf:cmixinttotal} (voltaje frente intensidad total) los parámetros son $a = 8,47 \cdot 10^-2$ y $b = 1,32 \cdot 10^6$. El resto se pueden calcular análogamente con las fórmulas \ref{ec:a} y \ref{ec:b}. Para este ajuste obtenemos un coeficiente de regresión lineal utilizando la fórmula \ref{ec:r} de $r = 0,99993$ que, pese a ser el más bajo de las prácticas realizadas sigue teniendo cuatro nueves, lo cual hace que sea satisfactorio.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CC8.pgf}
    \caption{Voltaje (V) frente a intensidad (I) con regresión lineal}
  \end{figure}

  Si comprobamos el valor de la resistencia equivalente calculado en \ref{sec:reseqmixto} ($R = 1,3210 \cdot 10^6$) y lo comparamos con la pendiente de la recta ($b = 1,32 \cdot 10^6$) vemos que son prácticamente la misma.

  Podemos probar a hacer la regresión de las diferentes gráficas de la figura \ref{graf:cmixmulti} simplemente cómo curiosidad, y para verificar que todos los datos siguen patrones lineales.

  \begin{figure}[H]
    \centering
    \input{CC8VMult.pgf}
    \input{CC8IMult.pgf}
    \input{CC8Mult.pgf}
    \caption{Voltajes (\textcolor{Blue}{$V$}, \textcolor{Red}{$V_1$}, \textcolor{Yellow}{$V_{23}$}, \textcolor{Green}{$V_4$}) frente a intensidades (\textcolor{Black}{$I$}, \textcolor{DarkGrey}{$I_1$}, \textcolor{Grey}{$I_2$}) con regresión lineal}
  \end{figure}

  En esta última regresión nos encontramos problemas que hasta ahora no habían aparecido. Pese a que alguna de las rectas tiene coeficientes de regresión de hasta $r = 0,99998$ ($V$ frente a $I_1$ y $V_4$ frente a $I_1$), otras no se encuentran tan próximas. Son varias las que sólo tienen un ajuste de dos nueves, cómo $V_1$ frente a $I$ ($r = 0,997$) o $V_{23}$ frente a $I_2$ ($r = 0,997$). Discutiremos esto en el apartado de conclusiones.


  \newpage
  \section{Conclusiones}

  \subsection{Medida de resistencias}

  Comprobamos que los valores nominales de las resistencias (\ref{tb:valnomres}) y las mediciones experimentales de las mismas (\ref{tab:res}) se encuentran dentro de la incertidumbre marcada por el fabricante.

  \subsection{Ley de Ohm}

  Hemos verificado la Ley de Ohm (\ref{ec:ohm}) en múltiples ocasiones, ya que en nuestras gráficas de Voltaje (\textit{V}) frente a Intensidad (\textit{I}) la linea obtenida mediante ajuste por mínimos cuadrados cumplía varias condiciones:

  \begin{itemize}[label=$-$]
    \item Es una recta que prácticamente pasa por el origen. Los términos \textit{a} (Ordenada en el origen) son despreciables frente a las magnitudes de \textit{V}. Lo calculamos manualmente en \ref{v:ohm} y \ref{v:serie} para los dos primeros circuitos, y en los apartados \ref{v:paralelo} y \ref{v:mixto} para los segundos. En todos los casos utilizamos la ecuación \ref{ec:a} para calcular el valor de \textit{a}.
    \item La pendiente de esta recta, \textit{b}, coincide con el valor teórico de la resistencia equivalente (\ref{ec:reseq} en serie y \ref{ec:resparalelo} en paralelo) y del valor de la medida del polímetro dentro del márgen de incertidumbre. El caso del circuito en serie (\ref{sec:reseqserie}) es una excepción, ya que el valor de la resistencia equivalente y la medida del polímetro no entran dentro del márgen de error, pero por un orden de magnitud de $10^2$, mientras que la medida es del orden de $10^5$. Consideraremos que se trata de un error en las condiciones del experimento, por ejemplo, a causa de la humedad, la temperatura, etc... En el resto de secciones se verifica perfectamente, y podemos ver los ajustes y valores de \textit{b} en las secciones \ref{sec:ajusteminres}, \ref{sec:ajusteminimoscuadradosserie}, \ref{v:paralelo} y \ref{v:mixto}.
  \end{itemize}

  \subsection{Leyes de Kirchhoff}

  También hemos verificados las Leyes de Kirchhoff (\ref{ec:kriser} en serie y \ref{ec:kripar} en paralelo) en los distintos circuitos:

  \begin{itemize}[label=$-$]
    \item En el circuito en serie, la suma de los voltajes en bornes de cada resistencia fue aproximadamente igual al voltaje total del circuito para cada medición, con incertidumbres atribuibles a los aparatos de medición o a los cables de conexión.
    \item En el circuito en paralelo, la suma de las intensidades en bornes de cada resistencia se aproximó a la intensidad total del circuito para cada medición, de nuevo con incertidumbres atribuibles a las técnicas de medición.
    \item En el circuito mixto, la suma de los voltajes en bornes de $R_1$, $R_{23}$ y $R_4$ coincide con el voltaje total, mientras que las intensidades en bornes de las resistencias $R_2$ y $R_3$ suman el valor de la intensidad total del circuito.
  \end{itemize}

  \subsection{Otras consideraciones}

  Por último, es necesario discutir una menor precisión de ajuste en el apartado \ref{v:mixto}. Mientras que el resto de regresiones lineales tenían un coeficiente (\ref{ec:r}) de al menos cuatro nueves, en algunas de las rectas que ajustamos en la última sección la precisión disminuyó a dos. Si bien la recta principal (V total frente a I total) cuenta con un $r = 0,99993$ que es bastante decente, otras cómo $V_1$ frente a $I$ o $V_{23}$ frente a $I_2$ tan solo llegan a $r = 0,997$. Esto se puede deber tanto a errores causados por las condiciones del laboratorio tras un periodo de tiempo prolongado (Mayor temperatura por la agrupación de tantos cuerpos, sudoración en las manos...), y también a algún error humano debido a la repetición de mediciones, pese a que tratamos de evitarlos en la medida de lo posible. De todas maneras, la desviación sobre el resultado no es crítica, y los datos siguen siendo coherentes (excepto el valor tres de $V_1$ que es menor que el de $V_23$ cuando debería de ser al revés), pero queríamos dejar constancia de esta disminución en la precisión del último experimento.

  En general, consideraríamos la práctica exitosa, ya que comprobamos tanto la \textbf{Ley de Ohm} cómo la \textbf{Ley de Kirchhoff} para la asociación de resistencias, y los resultados fueron satisfactorios.




  \newpage
  \part{Corriente Alterna}

  \section{Objetivos}
  \begin{itemize}[label=$-$]
    \item Comparar los valores teóricos y experimentales de la frecuencia de corte en un circuito RC.
    \item Medir la variación del módulo de la impedancia al variar la frecuencia.
    \item Obtener la fase de la impedancia utilizando el método de las dos trazas
  \end{itemize}

  \section{Circuito RC}

  En esta práctica trabajaremos con un circuito RC (Resitencia-Condensador) al que le suminstraremos corriente alterna desde un generador de señales senosoidales.

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[sV, l=$V_{in}$] (0,3)
      to[R, l=R] (3,3)
      to[capacitor, l=C] (3,0);
      \draw (0,0) node[tlground]{};
      \draw (3,0) node[tlground]{};
      \draw (1.5,0) node[]{$V_{out}$};
    \end{circuitikz}
    \caption{Circuito RC}
  \end{figure}

  \subsection{Cálculo de $f_c$ y $T$}

  En este circuito se conectan una resistencia y un condensador en serie. El potencial total del circuito ($V(t)$) coincide con la suma de los dos potenciales en bornes:
  \begin{equation}
    V(t) = V_R(t) + V_C(t)
  \end{equation}
  Mientras tanto, la intensidad viene dada por una fórmula distinta:
  \begin{equation}
    I(t) = I_m sen(wt + \varphi)
  \end{equation}
  En esta ecuación la fase ($\varphi$), la amplitud de la intensidad ($I_m$) y el módulo de la magnitud compleja, también llamado Impedancia ($Z$), están definidas de la siguiente manera:
  \begin{gather}
    \varphi = arctg\left(-\frac{X_C}{R}\right) = arctg\left(-\frac{1}{\omega RC}\right) \label{ec:faseimp} \\
    I_m = \frac{V_m}{Z} \\
    \hat{Z} = R + \frac{1}{j\omega C} \label{ec:zhat} \\
    Z = \sqrt{R^2+X_C^2} = \sqrt{R^2+\frac{1}{w^2C^2}} \label{ec:moduloimp1}
  \end{gather}
  Con esto podemos determinar la \textbf{frecuencia de corte} ($f_c$), que podemos calcular utilizando la ecuación \ref{ec:zhat}. Para esta frecuencia $R = X_C$.
  \begin{equation}
    R = \frac{1}{\omega C} \Rightarrow \omega = \frac{1}{RC} \Rightarrow f_c = \frac{1}{2\pi RC} \label{ec:fcorte}
  \end{equation}
  También podemos definir la \textbf{constante de tiempo} (o tiempo de respuesta) del circuito:
  \begin{equation}
    T = RC \label{ec:Tresp}
  \end{equation}
  Además podemos deducir los valores del módulo (\ref{ec:moduloimp1}) y la fase (\ref{ec:faseimp}) de la impedancia para la frecuencia de corte:
  \begin{gather}
    Z = R\sqrt{2} = R\left(\frac{V_m}{V_mR}\right) \label{ec:moduloimp2} \\ \varphi = \frac{\pi}{4} \nonumber
  \end{gather}
  En este caso en particular, si seguimos las ecuaciones \ref{ec:fcorte} y \ref{ec:Tresp}, obtenemos los siguientes valores para la frecuencia de corte ($f_c$) y la constante de tiempo ($T$)
  \begin{gather}
    f_c = \frac{1}{2\pi \cdot 10^4 \cdot 12 \cdot 10^{-9}} = 1326,29 Hz \qquad T = 10^4 \cdot 12 \cdot 10^{-9} = 1,2 \cdot 10^{-4} s \nonumber
  \end{gather}

  \subsection{Procedimiento de medición}

  Ahora realizaremos una serie de medidas del potencial total del circuito ($V_m$) y de los potenciales en bornes de la resistencia ($V_{mR}$) y del condensador ($V_{mR}$) para distintas frecuencias. Para ello haremos uso de un \textbf{osciloscopio}. Utilizaremos dos canales, colocados de la manera que indica el siguiente gráfico. El cable positivo de CH1 siempre acompaña al positivo de la fuente de alimentación, mientras que su tierra se conecta con la conexión de tierra de la fuente. En cada medición, manteniendo la frecuencia constante, cambiaremos de lado los cuatro cables, intercambiando dos a dos. Por el contrario, sólo conectaremos el cable positivo de CH2, y se mantendrá siempre entre $R$ y $C$.

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (-2,1.5) node[oscopeshape](os){CH1};
      \draw (os.in 1) to[short, *-] ++(0,-1.2) node[tlground]{};
      \draw (os.in 2) to[short, *-] ++(0,-0.6) -- (0,0.6) node[]{};

      \draw (3,3) node[oscopeshape](os2){CH2};

      \draw (0,0) to[sV, l=$V_{in}$] (0,3)
      to[R, l=R] (os2.left);
      \draw (os2.south) to[capacitor, l=C] (3,0);
      \draw (0,0) node[tlground]{};
      \draw (3,0) node[tlground]{};
      \draw (1.5,0) node[]{$V_{out}$};
    \end{circuitikz} \qquad

    \begin{circuitikz}[european]
      \draw (-2,1.5) node[oscopeshape](os){CH1};
      \draw (os.in 1) to[short, *-] ++(0,-1.2) node[tlground]{};
      \draw (os.in 2) to[short, *-] ++(0,-0.6) -- (0,0.6) node[]{};

      \draw (3,3) node[oscopeshape](os2){CH2};

      \draw (0,0) to[sV, l=$V_{in}$] (0,3)
      to[capacitor, l=C] (os2.left);
      \draw (os2.south) to[R, l=R] (3,0);
      \draw (0,0) node[tlground]{};
      \draw (3,0) node[tlground]{};
      \draw (1.5,0) node[]{$V_{out}$};
    \end{circuitikz}

    \caption{Medición del potencial total del circuito RC ($V_m$), y del potencial en bornes del condensador ($V_{mC}$, izquierda) y de la resistencia ($V_{mR}$, derecha).}
  \end{figure}

  \subsection{Medición experimental}

  Siguiendo el procedimiento que acabamos de mencionar, seleccionaremos una serie de frecuencias en torno a la frecuencia de corte y mediremos para ellas $V_m$, $V_{mR}$ y $V_{mC}$. Exponemos ahora un ejemplo de medición.

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|c|c|,
    table head=\hline Medida & $f (Hz)$  & $V_m (V)$ & $V_mR (V)$ & $V_mC (V)$ \\ \hline,
    late after last line=\\\hline,
    filter test=\ifnumless{\thecsvrow}{2},
    separator=semicolon
    ]{CA4.csv}
    {f=\f, Vm=\vm, VmR=\vmr, VmC=\vmc}
    {\thecsvrow & \f & \vm & \vmr & \vmc}
  \caption{Ejemplo de las mediciones de potenciales según la frecuencia}
  \end{table}

  Antes de mostrar todas las medidas, vamos a calcular otros campos para mostrar en la tabla. Primero, $\log f$, el logaritmo en base 10 de la frecuencia. Después calcularemos $Z$, el módulo de la impedancia, siguiendo la ecuación \ref{ec:moduloimp2}. Consideremos también la escala logarítmica de $Z$, en este caso, $20\log Z$, para poder representarlo posteriormente frente a la escala logarítmica de la frecuencia. Por último calcularemos el valor de $\frac{V_{mR}}{V_{mC}}$ para comprobar si es igual a 1 en la frecuencia de corte que habíamos predicho. También cabe hacer una aclaración. El potencial del circuito $V_{m}$ varió en su medición entre 20,40 y 20,60 Hz. Su valor oscilaba rápidamente entre ambos, impidiendo establecer uno u otro resultado como fiable. Esto se repitió a lo largo de toda la experiencia, por lo que consideramos utilizar 20,50 Hz cómo valor de $V_m$, en especial para evitar perturbaciones en las gráficas que realicemos. Discutiremos esto en el apartado de conclusiones con más detalle.

   Ahora sí, expondremos todos los resultados de la medición experimental:

  \begin{table}[H]
  \centering
  \resizebox{\columnwidth}{!}{
  \csvreader[
    tabular=|c|c|c|c|c|c|c|c|c|,
    table head=\hline Medida & $f (Hz)$ & $\log f$ & $V_m (V)$ & $V_mR (V)$ & $V_mC (V)$ & $Z (\Omega)$ & $20\log Z$ & $V_{mR}/V_{mC}$ \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CA4Alt.csv}
    {f=\f, logf=\logf, Vm=\vm, VmR=\vmr, VmC=\vmc, Z=\z, 20logZ=\logz, VmRVmC=\vmbyvm}
    {\thecsvrow & \f & \logf & \vm & \vmr & \vmc & \z & \logz & \vmbyvm}}
  \caption{Medición de potenciales frente a frecuencia}
  \label{tb:ac1}
  \end{table}

  Como podemos observar, y tal cómo se deduce de \ref{ec:moduloimp1}, el módulo de la impedancia ($Z$) decrece a medida que aumenta la frecuencia (ya que $f = \frac{w}{2\pi}$ y $\frac{1}{w^2C^2} = \frac{1}{4\pi^2f^2C^2}$).

  \subsection{Representación gráfica de Z frente a f}

  Si representamos el logaritmo de f frente al logaritmo de Z (escalado por un factor de 20) observaremos una parte de una hipérbola. Sus asíntotas, la horizontal debida a R y la oblicua debida a C, se pueden predecir de la ecuación \ref{ec:moduloimp2}, la primera imaginando que el circuito sólo consta de una resistencia y la segunda utilizando sólamente un condensador. En escala logarítmica se representan cómo rectas, y se intersecarán en el valor del eje de abscisas que se corresponde con la frecuencia de corte. Utilizaremos el siguiente código de \code{python} para la visualización de los datos:

  \begin{python}
    import matplotlib.pyplot as plt
    import pandas as pd
    import numpy as np

    d = pd.read_csv(name + ".csv", sep=';', decimal=',')

    r = 10**4
    f = d["f"]
    vm = d["Vm"]
    vmr = d["VmR"]

    logf = np.log10(f)
    logz = 20 * np.log10(r * (vm / vmr))

    plt.scatter(logf, logz)
  \end{python}

  \begin{figure}[H]
    %\centering
    \resizebox{\columnwidth}{!}{
    \input{CA4Alt.pgf}
    \input{CA4AltAll.pgf}}
    \caption{Frecuencia (en Hz, escala logarítmica) frente al módulo de la impedancia (En Ohmios, escala logarímica escalada por 20)}
  \end{figure}

  Como se observa en la gráfica, parece que los puntos trazan una curva, aunque hay bastante "ruído" para comprobarlo. Discutiremos esto en el apartado de conclusiones y hablaremos de la fiabilidad de nuestras medidas. Sin embargo, tomamos más de las 20 mediciones exigidas, ya que al principio medimos desde la frecuencia más baja hasta la de corte únicamente, y luego nos dimos cuenta de que teníamos que situar la frecuencia de corte en el medio de nuestros datos. Por ese despiste, contamos con puntos extra para visualizar nuestra gráfica, dibujados a la derecha en un tono más claro, y se aprecia mejor que no es una recta. Los datos utilizados para esta representación se encuentran en el anexo al final de las memorias (\ref{extra1}).

  Ahora calcularemos las dos asíntotas de la gráfica, la horizontal si no hubiera un condensador ($Z = R$) y la oblicua si no hubiera una resistencia ($Z = \frac{1}{wC} = \frac{1}{2\pi fC}$). Podemos hacerlo añadiendo la siguiente función a nuestro código anterior:

  \begin{python}
    c = 1.2 * 10**-8

    def asintotas(r, c, f, v1, v2):
        x = np.log10(f)

        #Curva R
        yr = 20 * np.log10(r) * np.ones(v1.shape[0])
        plt.plot(x, yr, color="tomato", zorder=0)

        #Curva C
        z = 1 / (2 * np.pi * f * c)
        yc = 20 * np.log10(z)
        plt.plot(x, yc, color="gold", zorder=0)

        #Interseccion
        m1, b1 = 0, yr[0]
        m2, b2 = np.polyfit(x, yc, 1)
        xint = (b2 - b1) / (m1 - m2)
        yint = m1 * xint + b1
        print("Interseccion: x", xint, "y", yint)
        plt.scatter(xint, yint, color="dodgerblue", zorder=3)

    asintotas(r, c, f, vm, vmr)
  \end{python}

  \begin{figure}[H]
    %\centering
    \resizebox{\columnwidth}{!}{
    \input{CA4AltR.pgf}
    \input{CA4AltAllR.pgf}}
    \caption{Frecuencia (en Hz, escala logarítmica) frente al módulo de la impedancia (En Ohmios, escala logarímica escalada por 20), con rectas \textcolor{Red}{R} y \textcolor{Golden}{C}}
  \end{figure}

  Como podemos observar, en ámbas gráficas (la que cuenta con 20 puntos de datos y la extendida) el punto de intersección de las dos rectas \textcolor{Red}{R} y \textcolor{Golden}{C} se encuentra en el punto $(3,1226388, 80)$, calculado con \code{python}. Si tomamos el inverso del logaritmo en base 10, obtenemos $f = 10^{3,1226388} = 1326,29 Hz$, la frecuencia de corte calculada teóricamente.

  \subsection{Representación gráfica de $\frac{V_{mR}}{V_{mC}}$ frente a f}
  \label{sec:vmf}

  También podemos crear otra gráfica, en esta ocasión representando $\frac{V_{mR}}{V_{mC}}$ frente a la frecuencia (\textit{f}). Sabemos que en aquella frecuencia para la que $\frac{V_{mR}}{V_{mC}} = 1$ será la frecuencia de corte.

  \begin{python}
    import matplotlib.pyplot as plt
    import pandas as pd
    import numpy as np

    d = pd.read_csv(name + ".csv", sep=';', decimal=',')
    x = d["f"]
    vmr = d["VmR"], vmc = d["VmC"]
    y = vmr / vmc

    plt.scatter(x,y, zorder=2)
  \end{python}

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CA4V.pgf}
    \caption{$\frac{V_{mR}}{V_{mC}}$ frente a la frecuencia ($f$). Representación ajustada y con la frecuencia de corte marcada.}
  \end{figure}

  Aquí la frecuencia de corte está representada por el punto rojo, y se calcula añadiendo este pequeño código de \code{python} que ajusta la recta y averigua el $x$ que corresponde a $y = 1$. En este caso obtenemos una frecuencia de corte de 1308.90 Hz, que si bien no es exactamente igual a la teórica, se aproxima razonablemente.

  \begin{python}
    m, b = np.polyfit(x, y, 1)
    plt.plot(x, m*x + b, zorder=1, color="skyblue")
    x2 = (1 - b)/m
    plt.scatter(x2, 1, zorder=3, color="tomato")
    print("Frecuencia corte:", x2)
  \end{python}



  \newpage
  \section{Desfase entre señales}

  Ahora utilizaremos el mismo circuito que en el apartado anterior, configurado para medir el voltaje total ($V_m$, en este caso llamado $V_G$) y el voltaje en bornes de la resistencia ($V_{mR}$, en este caso llamado $V_R$).

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (-2,1.5) node[oscopeshape](os){CH1};
      \draw (os.in 1) to[short, *-] ++(0,-1.2) node[tlground]{};
      \draw (os.in 2) to[short, *-] ++(0,-0.6) -- (0,0.6) node[]{};
      \draw (3,3) node[oscopeshape](os2){CH2};
      \draw (0,0) to[sV, l=$V_{in}$] (0,3)
      to[capacitor, l=C] (os2.left);
      \draw (os2.south) to[R, l=R] (3,0);
      \draw (0,0) node[tlground]{};
      \draw (3,0) node[tlground]{};
      \draw (1.5,0) node[]{$V_{out}$};
    \end{circuitikz}
    \caption{Circuito RC preparado para mediciones con el osciloscopio}
  \end{figure}

  \subsection{Procedimiento de medición}

  Vamos a configurar el osciloscopio para una observación dual, colocando las dos señales (CH1 y CH2) en la pantalla. Utilizamos los diales para ajustar la posición y ampliación de las curvas y cambiamos el modo a "Tiempo". Esto nos da acceso a dos cursores, \textit{t1} y \textit{t2}, que podremos mover en cada curva.

  \begin{figure}[H]
    \centering
    \input{Osciloscope1.pgf}
    \caption{Visualización de $V_G$ y $V_R$ en el osciloscopio}
  \end{figure}

  Podemos observar en la figura que las curvas $V_G$ y $V_R$ intersecan al eje horizontal en diversos puntos. Tomaremos dos puntos contiguos en los que la distancia entre ambas curvas sea la mínima, y nombraremos los cursores \textit{t1} para $V_G$ y \textit{t2} para $V_R$. Utilizando estos dos datos, podemos calcular la diferencia de fase entre ambas señales, $\varphi$.

  \begin{equation}
    \varphi = -2\pi f (t_2 - t_1) = -2\pi f \Delta t
    \label{ec:desfase}
  \end{equation}

  De aquí en adelante llamaremos $\Delta t = (t_2 - t_1)$ a la diferencia entre ambos tiempos. Con esta información procederemos a las mediciones.

  \subsection{Medición experimental}

  Procederemos de la siguiente manera. Variaremos la frecuencia en torno a la frecuencia de corte y mediremos $\Delta t$ utilizando el método descrito en la sección anterior. Completaremos una tabla de la siguiente manera:

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|,
    table head=\hline Medida & $f (Hz)$ & $\Delta t (s)$ \\ \hline,
    late after last line=\\\hline,
    filter test=\ifnumless{\thecsvrow}{2},
    separator=semicolon
    ]{CA5.csv}
    {f=\f, deltat=\dt}
    {\thecsvrow & \f & \dt}
  \caption{Ejemplo de las mediciones de $\Delta t$ según la frecuencia}
  \end{table}

  Antes de completar todos los resultados añadiremos tres columnas adicionales a la tabla. Estas serán el $\log f$ y el desfase ($\varphi$), tanto en radianes como en grados sexagesimales. Así podremos representar la gráfica de la próxima sección. Ahora si, presentamos los resultados obtenidos:

  \begin{table}[H]
  \centering
  \csvreader[
    tabular=|c|c|c|c|c|c|,
    table head=\hline Medida & $f (Hz)$ & $\log f$ & $\Delta t (s)$ & $\varphi (rad)$ & $\varphi$ \textit{(º)} \\ \hline,
    late after last line=\\\hline,
    separator=semicolon
    ]{CA5.csv}
    {f=\f, logf=\logf, deltat=\dt, phirad=\phir, phideg=\phid}
    {\thecsvrow & \f & \logf & \dt & \phir & \phid}
  \caption{Mediciones de $\Delta t$ según la frecuencia}
  \end{table}

  Cómo en el apartado anterior, tuvimos tiempo extra en esta práctica, y tras tratar de revisar un problema (expuesto en las conclusiones) decidimos emplearlo en tomar más medidas, para frecuencias más pequeñas y más grandes. En el caso de frecuencias pequeñas, el "ruído" de las ondas impedía hacer una estimación apropiada, puesto que añadía una incertidbumbre considerable. Para frecuencias grandes, el valor de $\Delta t$ se hacía tan pequeño que también comenzaba a ser complicado calcularlo con certeza. Por eso le daremos menor importancia a estos resultados extremos, teniendo en cuenta el error que pueden acarrear. Están expuestas en el siguiente anexo (\ref{extra2}).

  \begin{figure}[H]
    \centering
    \input{Osciloscope2.pgf}
    \input{Osciloscope3.pgf}
    \caption{Problemas en mediciones de frecuencias muy altas (superior) y muy bajas (inferior)}
  \end{figure}

  \subsection{Representación gráfica de $\varphi$ frente a f}

  En la siguiente gráfica veremos la relación entre los valores del desfase $\varphi$ representado frente a la escala logarítmica de la frecuencia. Utilizaremos un programa muy similar al descrito en el apartado \ref{sec:vmf}. Si simplemente tomamos los 20 valores de la tabla superior, y tratamos de justar a una recta, podemos ver que el ajuste no es demasiado perfecto.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CA5.pgf}
    \caption{Primer intento de representación de $\varphi$ frente a f (escala logarítmica)}
  \end{figure}

  Probemos ahora a representar todos los puntos obtenidos, incluyendo aquellos que se aproximan más a los extremos.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CA5NoSigAll.pgf}
    \caption{Segundo intento de representación de $\varphi$ frente a f (escala logarítmica), ampliando los puntos seleccionados hacia los extremos}
  \end{figure}

  ACTUALIZACIÓN: (Saltar a sección \ref{sec:arctg} para el ajuste final, evitando este razonamiento que resultó ser erróneo.)

  Podemos observar que hacia los lados la gráfica ya no se comporta cómo una recta. También vemos que parece tener un punto de inflexión alrededor del 3, y que parece (mirando desde arriba) cóncava hasta ese valor y convexa después. Podría tratarse de una gráfica polinómica, aunque no parece ajustarse a ninguna de sus definiciones. Probamos a ajustar a diversos polinomios para comprobar que efectivamente ninguno termina de cuadrar.

  \begin{python}
    p2 = np.polynomial.Polynomial.fit(x2, y2, 2)
    plt.plot(*p2.linspace(), color="tomato")
    ...
  \end{python}

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CA5PolyAll.pgf}
    \caption{Tercer intento de representación de $\varphi$ frente a f (escala logarítmica), ajustando a polinomios de grado \textcolor{Red}{2}, \textcolor{Golden}{3}, \textcolor{Green}{4} y \textcolor{Blue}{5}}
  \end{figure}

  Alguno se acerca, pero parece excesivamente complicado para representar estos valores. Entonces pensamos en una función sigmoide. Por ejemplo, la función logística, generalmente definida cómo $S(x) = \frac{1}{1+e^{-x}}$, es una curva con centro en (0, 0,5) que tiene asíntotas en 0 y en 1. Nuestra función no cumple estas propiedades, sin embargo, su forma parece aproximarse a una sigmoide.

  Si quieremos ajustar a dicha función, primero normalizaremos los datos. Para empezar, la curva logísitica siempre es positiva, así que tomaremos nuestro valor mínimo, -99,4, que redondearemos a 100 para hacerlo más simple, y sumaremos 100 a todos los puntos de la función, moviéndola en el eje vertical. Esto no es completamente correcto, ya que no podemos saber cúal es la asíntota horizontal a la que converge sin más datos, pero haremos una aproximación. Ahora, cómo los datos irán de 0 hasta $100-14,6=85,4$, multiplicaremos la función por $\frac{1}{85,4}$, que de nuevo redondearemos a 0.01 para hacer los cálculos más sencillos, ya que estamos buscando una aproximación. Por último, el valor medio de y ha de estar en $x=0$. Es posible pensar que ese punto de inflexión será la frecuencia de corte, por lo que probaremos a desplazar toda la función $log(1326,29) = 3,1226$ unidades hacia la izquierda. Para todo ello haremos uso de este código de \code{python}:

  \begin{python}
    y3 = (y2 + 100) * 0.01
    x3 = x2 - 3.1226
  \end{python}

  Ahora construiremos una función que ajuste a la sigmoide, haciendo uso de una librería de \code{scypi} llamada \code{optimize}, que nos devolverá los parámetros óptimos (\code{popt}) así como su covarianza (\code{pcov}):

  \begin{python}
    from scipy.optimize import curve_fit

    def sigmoide(x, a, b):
        return 1.0 / (1.0 + np.exp(-a*(x-b)))

    popt, pcov = curve_fit(sigmoide, x3, y3, method='dogbox')
  \end{python}

  Por último, generamos los puntos de la función y volvemos a desnormalizarlos deshaciendo los cambios que aplicamos anteriormente, y dibujamos la función.

  \begin{python}
    xs = np.arange(-3., +3., 0.01)
    ys = (sigmoide(xs, *popt) * 100) - 100
    xs += 3.1226

    plt.plot(xs, ys, color="gold")
  \end{python}

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CA5All.pgf}
    \caption{Representación de $\varphi$ frente a f (escala logarítmica) con un ajuste a una curva sigmoide}
  \end{figure}

  Se puede observar que el ajuste se acerca mucho a los datos. No podemos asegurar que la curva sigmoide sea la apropiada para ajustar estos datos, y hemos hecho muchas aproximaciones y asunciones que podrían hacer que esta representación sea errónea.

  \subsection{Ajuste correcto}
  \label{sec:arctg}

  Revisando la práctica nos dimos cuenta de un error en este razonamiento. Decidimos mantenerlo porque muestra el camino que seguimos hasta llegar a este punto, pero procederemos a explicar el nuevo camino al que arrivamos.

  En este sección hemos utilizado la ecuación \ref{ec:desfase}, pero no hemos vuelto al origen, la ecuación \ref{ec:faseimp}. Allí se describe la impedancia como un arcotangente. Esto tiene mucho sentido, ya que la función sigmoide y la arcotangente tienen una forma muy similar pese a ser distitnas. Por ejemplo, ambas se utilizan en redes neuronales para la misma función. Esta similaridad nos llevó a la confusión, pese a que la respuesta estaba todo el rato en la ecuación \ref{ec:faseimp}. Podemos adaptar el código anterior para una arcotangente y representarla, primero normalizando nuestros datos. En esta ocasión no hace falta dividir la y por 100 ya que añadiremos ese parámetro a nuestro ajuste por arcotangente como un parámetro a.

  \begin{python}
    def farctan(x, a, b, c):
        xrad = np.deg2rad(x)
        return a * np.rad2deg(np.arctan(b * xrad)) + c

    y3 = (y2 + 45)
    x3 = x2 - 3.1226

    popt, pcov = curve_fit(farctan, x3, y3)

    xs = np.arange(-1.8, +2., 0.01)
    ys = (farctan(xs, *popt)) - 45
    xs += 3.1226
    plt.plot(xs, ys, color="gold")

    for i in range(len(ys)):
        if ys[i] < -44.5 and ys[i] > -45.5:
            plt.scatter(xs[i], ys[i], color="tomato", zorder=4)
            print("Frecuencia de corte:", xs[i], 10**xs[i])
  \end{python}

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CA5Arctan.pgf}
    \caption{Representación de $\varphi$ frente a f (escala logarítmica) con un ajuste a una curva arcotangente}
  \end{figure}

  Un problema que tuvimos con nuestros datos que evitamos comentar hasta ahora fue que para los valores cercanos a la frecuencia de corte obtivimos ángulos no centrados en 45º. Para 1300 Hz obtuvimos un ángulo de 48,6º, mientras que para 1360 Hz obtuvimos 47º. Comentamos este detalle con el profesor de la práctica, y repetimos estas mediciones para asegurar que no las habíamos tomado mal, pero el resultado apenas varió. Discutiremos esto más en profundidad en las conclusiones, sin embargo, esto afecta directamente a este apartado ya que utilizando este método aproximamos la frecuencia de corte a 1487.99 Hz, dónde la curva vale 45º. Esto difiere mucho de nuestra estimación, pero es un problema de los ángulos obtenidos para los datos que tomamos, no necesariamente del ajuste que hicimos de ellos.


  \newpage
  \section{Conclusiones}

  \subsection{Impedancia (Z) frente a frecuencia (f)}

  Tras mediciones de voltajes ($V_m$, $V_{mR}$ y $V_{mC}$) variando la resistencia, representamos el módulo de la impedancia (Z) frente a la frecuencia (f) en una escala logarítmica. Observamos que forman una hipérbola cuyas asíntotas son las rectas R (horizontal) y C (oblicua). Estas se cortan en la frecuencia de corte, que coincidía con la calculada teóricamente ($1326, 29 Hz$).

  \subsection{$\frac{V_{mR}}{V_{mC}}$ frente a frecuencia (f)}

  Representamos el cociente entre los voltajes en bornes de la resistencia y el condensador ($V_{mR}/V_{mC}$) frente a la frecuencia. Cúando los primeros resultaban 1 obteníamos la frecuencia de corte, en este caso de $1308.90 Hz$, razonablemente próxima a la teórica y a la averiguada por el método anterior.

  \subsection{Desfase ($\varphi$) frente a frecuencia (f)}

  Utilizamos el método de las dos trazas para estudiar la variación del argumento de la impedancia ($\varphi$) al variar la frecuencia, entre las señales del potencial total $V_m$ y el potencial en bornes de la resistencia $V_{mR}$. Añadimos mediciones de frecuencias muy altas y muy bajas, aunque su incertidumbre sería bastante elevada.

  Representamos $\varphi$ frente a la escala logarítmica de la frecuencia, y tras varios intentos de ajuste concluímos que se trataba de una función arcotangente. Tuvimos un problema con los valores del ángulo que medimos, ya que en la frecuencia de corte este valía en torno a 47-49º, cúando tenía que ser 45º. Repetimos las mediciones pero obtuvimos resultados muy similares. El resto de datos coinciden con la función que aproximamos y las relaciones entre los valores relativos parecen tener sentido. Concluimos por tanto que lo más probable es que se debiera a un \textbf{error sistemático}, o bien por parte de las herramientas de medida o por nuestra cuenta, ya que todos los valores parecen influenciados en la misma dirección. Solucionar este problema requeriría una inspección más próxima y una repetición completa de la práctica, con el mismo osciloscopio y con otro distinto, para discernir el origen del error.

  Sin embargo, podemos comprobar que el desfase es de 45º para la frecuencia de corte si utilizamos los datos de la primera sección, que no están influenciados por este error sistemático. Utilizando las ecuaciones \ref{ec:faseimp} y \ref{ec:fcorte} podemos deducir que:

  \begin{equation}
    \varphi = arctg\left(-\frac{1}{wRC}\right) \qquad \frac{V_{mC}}{V_{mR}} = 1 = \frac{1}{wRC} \qquad \varphi = arctg\left(-\frac{V_{mC}}{{V_{mR}}}\right) \nonumber
  \end{equation}

  Por lo tanto, podemos utilizar los datos de $\frac{V_{mC}}{V_{mR}}$ de la tabla \ref{tb:ac1} y representar los desfases ($\varphi$) de esos datos:

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{CA4AltArctan.pgf}
    \caption{Representación de $\varphi$ frente a f (escala logarítmica) con un ajuste a una curva arcotangente}
  \end{figure}

  De este modo obtenemos una frecuencia de corte de 1307,98 Hz, mucho más razonable en base a nuestras estimaciones. Vuelvo a reiterar que estos no son los mismos datos que la segunda parte, esos siguen teniendo un error sistemático que nos impedirá realizar el cálculo con precisión. Sin embargo, de esta manera, podemos probar de otro modo que para la frecuencia de corte la fase es de 45º.

  Por lo general, consideramos la primera parte de la práctica exitosa, ya que aproximamos muy bien el valor de la frecuencia de corte, mientras que esta segunda parte sólo parcialmente, ya que no pudimos acercarnos todo lo deseado a ella con los datos que obtuvimos.



  \newpage
  \begin{appendices}
    \addtocontents{toc}{\protect\setcounter{tocdepth}{2}}
    \makeatletter
    \addtocontents{toc}{%
    \begingroup
    \let\protect\l@chapter\protect\l@section
    \let\protect\l@section\protect\l@subsection
    }

    \section{Datos extra}

    \subsection{Corriente alterna: Circuito RC}
    \label{extra1}

    \begin{table}[H]
    \centering
    \resizebox{!}{4in}{
    \csvreader[
      tabular=|c|c|c|c|c|c|c|c|c|,
      table head=\hline Medida & $f (Hz)$ & $\log f$ & $V_m (V)$ & $V_mR (V)$ & $V_mC (V)$ & $Z (\Omega)$ & $20\log Z$ & $V_{mR}/V_{mC}$ \\ \hline,
      late after last line=\\\hline,
      separator=semicolon
      ]{CA4AltAll.csv}
      {f=\f, logf=\logf, Vm=\vm, VmR=\vmr, VmC=\vmc, Z=\z, 20logZ=\logz, VmRVmC=\vmbyvm}
      {\thecsvrow & \f & \logf & \vm & \vmr & \vmc & \z & \logz & \vmbyvm}}
    \caption{Mediciones extra de potenciales frente a frecuencia}
    \end{table}

    \subsection{Corriente alterna: Desfase entre señales}
    \label{extra2}

    \begin{table}[H]
    \centering
    \resizebox{!}{4.8in}{
    \csvreader[
      tabular=|c|c|c|c|c|c|,
      table head=\hline Medida & $f (Hz)$ & $\log f$ & $\Delta t (s)$ & $\varphi (rad)$ & $\varphi$ \textit{(º)} \\ \hline,
      late after last line=\\\hline,
      separator=semicolon
      ]{CA5All.csv}
      {f=\f, logf=\logf, deltat=\dt, phirad=\phir, phideg=\phid}
      {\thecsvrow & \f & \logf & \dt & \phir & \phid}}
    \caption{Mediciones extra de $\Delta t$ según la frecuencia}
    \end{table}


    \section{Bibliografía}

    \subsection{Facultad de física}

    Amigo, Alfredo. \textit{Análisis de incertidumbres.} Apuntes de Técnicas Experimentales I, Facultad de Física, 2019-20.

    \textit{Práctica 1. Circuitos de Corriente Continua.} Apuntes de Técnicas Experimentales I, Facultad de Física, 2019-20.

    \textit{Práctica 2. Circuitos de Corriente Alterna.} Apuntes de Técnicas Experimentales I, Facultad de Física, 2019-20.

    \textit{Anexo Práctica 1. El Polímetro.} Apuntes de Técnicas Experimentales I, Facultad de Física, 2019-20.

    \textit{Anexo Práctica 2. El Osciloscopio.} Apuntes de Técnicas Experimentales I, Facultad de Física, 2019-20.

    \subsection{Otras fuentes}

    Wikipedia. \textit{Función sigmoide.} \url{https://en.wikipedia.org/wiki/Sigmoid_function}

    SciPy. \textit{Scypy - Optimize - Curve Fit.} \url{https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html}

    SciPy. \textit{Numpy - Polynomial - Fit.} \url{https://docs.scipy.org/doc/numpy/reference/generated/numpy.polynomial.polynomial.Polynomial.fit.html}

    \subsection{LaTeX}

    Redaelli, Massimo. \textit{CircuiTikZ.} \url{http://texdoc.net/texmf-dist/doc/latex/circuitikz/circuitikzmanual.pdf}

    Sturm, Thomas. \textit{The csvsimple package.} \url{https://osl.ugr.es/CTAN/macros/latex/contrib/csvsimple/csvsimple.pdf}

    \section{Código y datos}

    Todo el código y los datos utilizados para la creación de esta memoria se encuentran en un repositorio hospedado en GitHub. Puede accederse desde el siguiente enlace:

    \url{https://github.com/josekoalas/andromeda/tree/master/Instrumentacion}

    Dentro de la carpeta \code{Instrumentación} pueden encontrarse los siguientes ficheros:

    \begin{itemize}[label=$-$]
      \item Memoria.tex y Memoria.pdf: Archivo LaTeX y pdf generado para esta memoria.
      \item Graphics*.py: Archivos con código python para crear las gráficas en formato .pgf.
      \item CA*.pgf, CC*.pgf y Osciloscope*.pgf: Las distintas gráficas en formato vectorial adecuado para su uso en LaTeX, de corriente alterna y corriente continua.
      \item CA*.csv y CC*.csv: Tablas con los datos de la práctica utilizadas tanto en LaTeX cómo en python.
      \item R*.png: Imágenes con las resistencias con colores.
    \end{itemize}

    \addtocontents{toc}{\endgroup}
  \end{appendices}


\end{document}
