\documentclass[12pt, a4paper, titlepage]{article}

%INFORMACIÓN
\title{\textbf {Electricidad: Bobinas de Helmholtz y Curva de Carga}}
\author{{\Large Pazos Pérez, José}\\CAMBIAR DNI}
\date{}

%PAQUETES
\usepackage[dvipsnames]{xcolor} %Colorear texto y colores estándar
\usepackage{colortbl} %Colorear celdas de tablas
\usepackage{css-colors}

\definecolor{Red}{RGB}{222, 94, 80}
\definecolor{Blue}{RGB}{110, 176, 230}
\definecolor{LinkBlue}{RGB}{20, 88, 224}

\usepackage[centertags]{amsmath} %Excluir ecuaciones de la enumeración automática
\usepackage{csvsimple} %Tablas desde archivos .csv
\usepackage{pgfplots} %Gráficas desde matplotlib con .pgf
\usepackage{graphicx} %Imágenes
\usepackage[siunitx]{circuitikz} %Circuitos
\usepackage{pythonhighlight} %Código de python
\pgfplotsset{compat=1.16}

\usepackage{tocloft} %Crear listas (por ejemplo, de ecuaciones)
\usepackage{enumitem} %Cambiar los estilos de las listas
\usepackage[margin=0.8in]{geometry} %Márgenes
\usepackage[skip=12pt]{parskip} %Añadir espacio tras los párrafos
\usepackage{float} %Controlar el posicionamiento de gráficas y tablas con H
\usepackage[toc,page]{appendix} %Anexos
\usepackage{chngcntr} %Numeración de capítulos por partes
\usepackage{hyperref} %Añadir vínculos
\hypersetup{
    colorlinks=true,
    linkcolor=LinkBlue,
    filecolor=Red,
    urlcolor=Blue,
}

%CONFIGURACIÓN
\renewcommand{\contentsname}{Índice}
\renewcommand{\partname}{Experiencia}
\renewcommand{\listtablename}{Lista de Tablas}
\renewcommand{\listfigurename}{Lista de Figuras}
\renewcommand{\appendixpagename}{Anexos}
\renewcommand{\appendixtocname}{\large Anexos}
\renewcommand{\appendixname}{Anexo}
\renewcommand{\figurename}{Figura}
\renewcommand{\tablename}{Tabla}

\newcommand{\listecuacionesname}{\Large Lista de Ecuaciones}
\newlistof{ecuaciones}{equ}{\listecuacionesname}
\newcommand{\ecuaciones}[1]{\addcontentsline{equ}{ecuaciones}{\protect\numberline{\theequation}#1}\par}

\linespread{1.3}
\counterwithin*{section}{part}

\newcommand{\code}[1]{\texttt{#1}} %Formatear texto como código

%DOCUMENTO
\begin{document}
  \maketitle

  \tableofcontents

  \newpage
  \part{Bobinas de Helmholtz}

  \section{Objetivos}

  En esta práctica exploraremos las \textbf{Bobinas de Helmholtz}, una distribución de dos bobinas enfrentadas por las que circula corriente eléctrica en el mismo sentido. A raíz de ello se generará un campo magnético con la peculiaridad de ser prácticamente uniforme entre ambos aparatos. Tendremos dos metas principales:

  \begin{itemize}[label=$-$]
    \item Comparar el campo magnético entre las dos espiras predicho por la teoría con el que mediremos de manera experimental, variando la distancia entre las bobinas.
    \item Obtener el valor de la permeabilidad magnética del vacío mediante un ajuste de mínimos cuadrados realizado sobre datos tomados con la distancia entre las bobinas fija.
  \end{itemize}

  \subsection{Expresión para el campo magnético}

  La siguiente expresión describe el campo magnético que ambas bobinas producirán en un punto en el eje entre las dos.
  \begin{equation}
    B = \frac{\mu_0 I N}{2R} \cdot \left[\frac{1}{\left(1 + \left(\frac{z - \frac{a}{2}}{R}\right)^2 \right)^{3/2}} + \frac{1}{\left(1 + \left(\frac{z + \frac{a}{2}}{R}\right)^2 \right)^{3/2}}\right]
    \label{ec:B}
  \end{equation}
  En la que:
  \begin{itemize}[label=$-$]
    \item $\mu_0 = 4 \pi 10^{-7}$ - Permeabilidad magnética del vacío
    \item $R = 0.20m$ - Radio de las bobinas
    \item \textit{a} - Distancia entre las bobinas
    \item \textit{I} - Intensidad que recorre las bobinas
    \item $N = 154$ - Número de espiras
    \item \textit{z} - Distancia entre el punto medio entre las boninas y otro punto de el eje que une sus centros
  \end{itemize}

  \newpage
  \subsection{Diagrama}

  Para verificar esta ley y comprender mejor el funcionamiento de este dispositivo, utilizaremos dos bobinas con 154 espiras enrolladas, y las enfrentaremos. Luego les sumistraremos corriente eléctrica y mediremos el campo magnético con un teslámetro. No entraremos en detalles sobre el montaje pormenorizado por no haber realizado esta práctica, pero en la próxima imágen se puede observar cómo las bobinas enfrentadas producen el campo que mediremos.

  \begin{figure}[H]
    \centering
    \resizebox{9cm}{!}{\includegraphics{BH-Diagrama}}
    \caption{Diagrama del campo generado por dos Bobinas de Helmholtz}
  \end{figure}

  En cada una de las dos partes de la práctica explicaremos más en detalle la clase de mediciones que tomaremos y las leyes que queremos demostrar.

  \newpage
  \section{Variación del campo en el eje central}

  En esta primera experiecia colocaremos las bobinas de la manera descrita a tres distancias: Igual al radio, la mitad del radio y el doble del radio. Luego moveremos el teslamómetro desde el punto central hacia los lados, siempre siguiendo el eje central. De esta manera, obtendremos 50 medidas en las que lo único que variamos es la distancia, dejando la intensidad constante.

  \subsection{Tablas de datos}

  Procedemos a exponer las tablas que obtuvimos. En ellas se representa la distancia al centro (z) en metros (m) y el campo que medimos ($B_{exp}$) en teslas (T). La incertidumbre de ambas medidas es constante, por lo que la explicitaremos aquí y no en las tablas:
  \begin{gather}
    s(B_{exp}) = 0.01mT = 10^{-5}T \\
    z = d - d_0 \qquad s(z) = \sqrt{s(d)^2 + s(d_0)^2} = \sqrt{2} \cdot s(d) = \sqrt{2} \cdot 0,001m = 0,0014m
  \end{gather}
  La intensidad también será constante y su valor e incertidumbre se fijarán en $I = 2,55 \pm 0,01 A$.

  \subsubsection{Tabla 1: Separación a=R}

  \begin{figure}[H]
    \begin{table}[H]
      \centering
      \scalebox{.71}{
      \csvreader[
        tabular=|c|c|c|,
        table head=\hline Medida & $z(m)$ & $B_{exp}(T)$ \\ \hline,
        late after last line=\\\hline,
        filter test= \ifnumless{\thecsvrow}{25},
        separator=semicolon
        ]{BH-1.csv}
        {z=\z, Bexp=\be}
        {\thecsvrow & \z & \be}} \quad
      \scalebox{.71}{
      \csvreader[
        tabular=|c|c|c|,
        table head=\hline Medida & $z(m)$ & $B_{exp}(T)$ \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-1b.csv}
        {z=\z, Bexp=\be}
        {\the\numexpr25+\thecsvrow\relax & \z & \be}}
    \end{table}
    \caption{Variación de B con a=R}
  \end{figure}

  Para determinar la desviación cuadrática de los datos de la tabla anterior usaremos la siguiente fórmula:
  \begin{equation}
    s = \frac{1}{N} \sqrt{\sum{\left(B_{exp} - B_{teo}\right)^2}} \label{ec:s}
  \end{equation}

  Para nuestras medidas, obtenemos $s_1 = 1,1 \cdot 10^{-5} T$.

  \vspace{1cm}

  \begin{minipage}{0.49\textwidth}
    \subsubsection{Tabla 2: Separación a=R/2}

    \begin{figure}[H]
      \begin{table}[H]
        \scalebox{.71}{
        \csvreader[
          tabular=|c|c|c|,
          table head=\hline Medida & $z(m)$ & $B_{exp}(T)$ \\ \hline,
          late after last line=\\\hline,
          filter test= \ifnumless{\thecsvrow}{25},
          separator=semicolon
          ]{BH-2.csv}
          {z=\z, Bexp=\be}
          {\thecsvrow & \z & \be}} \quad
        \scalebox{.71}{
        \csvreader[
          tabular=|c|c|c|,
          table head=\hline Medida & $z(m)$ & $B_{exp}(T)$ \\ \hline,
          late after last line=\\\hline,
          separator=semicolon
          ]{BH-2b.csv}
          {z=\z, Bexp=\be}
          {\the\numexpr25+\thecsvrow\relax & \z & \be}}
      \end{table}
      \caption{Variación de B con a=R/2}
    \end{figure}

    Calculamos la desviación típica (\ref{ec:s}) con estos datos y obtenemos $s_2 = 3,3 \cdot 10^{-5} T$.
  \end{minipage} \hfill
  \begin{minipage}{0.49\textwidth}
    \subsubsection{Tabla 3: Separación a=2R}

    \begin{figure}[H]
      \begin{table}[H]
        \scalebox{.71}{
        \csvreader[
          tabular=|c|c|c|,
          table head=\hline Medida & $z(m)$ & $B_{exp}(T)$ \\ \hline,
          late after last line=\\\hline,
          filter test= \ifnumless{\thecsvrow}{25},
          separator=semicolon
          ]{BH-3.csv}
          {z=\z, Bexp=\be}
          {\thecsvrow & \z & \be}} \quad
        \scalebox{.71}{
        \csvreader[
          tabular=|c|c|c|,
          table head=\hline Medida & $z(m)$ & $B_{exp}(T)$ \\ \hline,
          late after last line=\\\hline,
          separator=semicolon
          ]{BH-3b.csv}
          {z=\z, Bexp=\be}
          {\the\numexpr25+\thecsvrow\relax & \z & \be}}
      \end{table}
      \caption{Variación de B con a=2R}
    \end{figure}

    Calculamos la desviación típica (\ref{ec:s}) con estos datos y obtenemos $s_3 = 7,5 \cdot 10^{-5} T$.
  \end{minipage}

  \newpage
  \subsection{Campo teórico}

  Ahora debemos calcular el campo magnético teórico para poder comprarlo con los datos que obtuvimos y poder crear la gráfica que contenga a ambos.

  Utilizaremos la ecuación \ref{ec:B} y sustituiremos los valores de a=R, a=R/2 y a=2R.
  \begin{gather*}
    B1_{teo} = \frac{\mu_0 I N}{2R} \cdot \left[\frac{1}{\left(1 + \left(\frac{z - \frac{R}{2}}{R}\right)^2 \right)^{3/2}} + \frac{1}{\left(1 + \left(\frac{z + \frac{R}{2}}{R}\right)^2 \right)^{3/2}}\right] \nonumber \\
    B2_{teo} = \frac{\mu_0 I N}{2R} \cdot \left[\frac{1}{\left(1 + \left(\frac{z - \frac{R}{4}}{R}\right)^2 \right)^{3/2}} + \frac{1}{\left(1 + \left(\frac{z + \frac{R}{4}}{R}\right)^2 \right)^{3/2}}\right] \nonumber \\
    B3_{teo} = \frac{\mu_0 I N}{2R} \cdot \left[\frac{1}{\left(1 + \left(\frac{z - R}{R}\right)^2 \right)^{3/2}} + \frac{1}{\left(1 + \left(\frac{z + R}{R}\right)^2 \right)^{3/2}}\right] \nonumber
  \end{gather*}

  Ahora, con estas ecuaciones, sustituiremos el valor del radio R=0.20m, la permeabilidad magnética $\mu_0 = 4 \pi 10^{-7}$, el número de espiras N=154 y la intensidad I=2,55A. Esto nos dará una fórmula general para calcular los valores de B sustituyendo las distancias z correspondientes. Presentamos los resultados corresponiendtes en las siguientes tablas:

  \textit{(En la siguiente página por comodidad de representación.)}

  \begin{figure}[H]
    \begin{table}[H]
      \centering
      \scalebox{.7}{
      \csvreader[
        tabular=|c|,
        table head=\hline Medida \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-1.csv}
        {}
        {\thecsvrow}} \quad
      \scalebox{.7}{
      \csvreader[
        tabular=|c|c|c|,
        table head=\hline $z1(m)$ & $B1_{exp}(T)$ & $B1_{teo}(T)$ \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-1.csv}
        {z=\z, Bteo=\bt, Bexp=\be}
        {\z & \be & \bt}} \quad
      \scalebox{.7}{
      \csvreader[
        tabular=|c|c|c|,
        table head=\hline $z2(m)$ & $B2_{exp}(T)$ & $B2_{teo}(T)$ \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-2.csv}
        {z=\z, Bteo=\bt, Bexp=\be}
        {\z & \be & \bt}} \quad
      \scalebox{.7}{
      \csvreader[
        tabular=|c|c|c|,
        table head=\hline $z3(m)$ & $B3_{exp}(T)$ & $B3_{teo}(T)$ \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-3.csv}
        {z=\z, Bteo=\bt, Bexp=\be}
        {\z & \be & \bt}} \quad
    \end{table}
    \caption{Campo magnético experimental frente a teórico para a=R, a=R/2 y a=2R}
  \end{figure}

  \subsection{Representación gráfica}

  Finalmente, teniendo los datos del campo magnético experimental y sabiendo calcular los del campo magnético teórico, representaremos ambos para poder compararlos. Cabe destacar que no utilizaremos los datos $B_{teo}$ de la tabla anterior, si no que computaremos la fórmula directamente en python para obtener una curva más suave. La tabla anterior era simplemente una demostración de cómo calcular el campo teórico.

  Primero procesaremos los datos en \code{python}, y para ello haremos uso de la librería \code{pandas}, que nos permite importar directamente archivos .csv, el mismo formato que usamos para representar las tablas de \LaTeX.

  \begin{python}
    import pandas as pd

    #Constantes
    pm = 4 * np.pi * 10**(-7); i = 2.55; n = 154; r = 0.2

    #Leer datos
    d1 = pd.read_csv("BH-1.csv", sep=';', decimal=',')
    z1 = d1["z"]; Be1 = d1["Bexp"] #Similarmente para las otras tablas
  \end{python}

  El siguiente paso es calcular las curvas teóricas, para las que utilizaremos una función por comodidad. Para ellas definiremos $z \subset [-0,450, 0,450]$ con medidas cada 0,02m, ya que nos dará una representación simétrica y que contenga todas las medidas experimentales.

  \begin{python}
    #Calculo campo magnetico
    B = lambda pm, i, n, r, a, z: ((pm * i * n) / (2 * r)) *
        ((1 / (1 + ((z - (a/2)) / (r))**2)**(3/2)) +
        (1 / (1 + ((z + (a/2)) / (r))**2)**(3/2)))

    #Curvas teoricas
    z = np.linspace(-0.450, 0.450, 450)
    Bt1 = B(pm, i, n, r, r, z)
    Bt2 = B(pm, i, n, r, r/2, z)
    Bt3 = B(pm, i, n, r, 2*r, z)
  \end{python}

  Por fin estamos listos para representar las gráficas, lo que haremos con ayuda de \code{matplotlib}. Las exportaremos utilizando un formato .pgf que \LaTeX puede leer de mandera vectorial.

  \begin{python}
    import matplotlib.pyplot as plt

    #Graficas experimentales (puntos)
    plt.scatter(z1,Be1);plt.scatter(z2,Be2);plt.scatter(z3,Be3)
    #Graficas teoricas (curvas)
    plt.plot(z,Bt1); plt.plot(z,Bt2); plt.plot(z,Bt2)
  \end{python}

  Además de nuestro programa original, utilizaremos un complemento común para todas las memorias que define el estilo de las gráficas y configura \code{matplotlib} para exportar .pgf y utilizar nuestra paleta de colores.

  Al ejecutar el código, obtenemos la siguiente gráfica:

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{BH.pgf}
    \caption{Campo magnético (B) frente a distancia del punto medio (z) para tres separaciones de bobinas (\textcolor{RoyalBlue}{a=R}, \textcolor{MediumSeaGreen}{a=R/2}, \textcolor{IndianRed}{a=2R})}
  \end{figure}

  Podemos observar que los datos experimentales no estan exáctamente encima de la gráfica, pero siguen la misma forma. Esto se debe a que las medidas de laboratorio pueden tener algún error, pero igualmente comprueba que las leyes se verifican. Además, esto se corresponde con obtener una desviación cuadrática (\ref{ec:s}) muy pequeña en comparación con nuestras medidas.


  \newpage
  \section{Permeabilidad magnética del vacío}

  En esta segunda parte de la práctica mantendremos el teslámetro en el centro de ambas bobinas y variaremos la intensidad. De esta manera podremos calcular la constante de permeabilidad magnética del vacío a partir de datos experimentales y comprarla con su valor teórico ($\mu_0 = 4 \pi 10^{-7}$).

  Si observamos la ecuación de B (\ref{ec:B}), observamos que al dejar z constante, B se relaciona con I a través de una constante:
  \begin{equation}
    B = c \cdot I \qquad c = \frac{\mu_0 N}{2R} \cdot \left[\frac{2}{\left(1 + \left(\frac{a/2}{R}\right)^2 \right)^{3/2}}\right] \nonumber
  \end{equation}

  Podemos simplificar todavía más este resultado si sustituímos a por R, R/2 y R2 respectivamente:
  \begin{gather}
    c_1 = \frac{\mu_0 N}{2R} \cdot \left[\frac{2}{\left(1 + \left(\frac{R}{2R}\right)^2 \right)^{3/2}}\right] = \frac{\mu_0 N}{R} \cdot \frac{2^3}{5\sqrt{5}} \nonumber \\
    c_2 = \frac{\mu_0 N}{2R} \cdot \left[\frac{2}{\left(1 + \left(\frac{R}{R}\right)^2 \right)^{3/2}}\right] = \frac{\mu_0 N}{R} \cdot \frac{2^6}{17\sqrt{17}} \nonumber \\
    c_3 = \frac{\mu_0 N}{2R} \cdot \left[\frac{2}{\left(1 + \left(\frac{R}{4R}\right)^2 \right)^{3/2}}\right] = \frac{\mu_0 N}{R} \cdot \frac{1}{2\sqrt{2}} \nonumber
  \end{gather}

  Nuestro objetivo es encontrar las constantes $c_n$, la pendiente de la recta $B = c \cdot I$, para poder despejar $\mu_0$ de ahí. Para ello haremos un ajuste por mínimos cuadrados sin término independiente. Luego utilizaremos estas fórmulas para calcular $\mu_0$ en base a c.
  \begin{gather}
    \mu_0 = \frac{c_1 R \cdot 5 \sqrt{5}}{N \cdot 2^3} = \frac{c_2 R \cdot 17 \sqrt{17}}{N \cdot 2^6} = \frac{c_3 R \cdot 2 \sqrt{2}}{N} \label{ec:mu}
  \end{gather}

  Tambien podemos calcular la indeterminación de $\mu_0$ mediante propagación de incertidumbres. Por comodidad usaremos \textit{K} para referirnos a la fracción en corchetes en la fórmula superir que sustituímos por la constante al incluír a=R, a=R/2 y a=2R. Vemos que es simplemente sustituír c por s(c) en la fórmula de $\mu_0$.
  \begin{gather}
    s(\mu_0) = \sqrt{\left(\frac{\partial \mu_0}{\partial c} \right)^2 \cdot s^2(c)} = \sqrt{\left( \frac{2R}{N} \cdot K \right)^2 \cdot s^2(c)} = \frac{2R}{N} \cdot K \cdot s(c) \label{ec:smu}
  \end{gather}

  \newpage
  \subsection{Tablas de datos}

  En las siguientes tablas de datos representamos el campo magnético ($B_{exp}$) en teslas (T) que medimos desde el punto medio de las bobinas junto a la intensidad ($I$) en amperios (A). La incertidumbre del campo magnético sigue siendo constante $s(B_{exp}) = 10^{-5}T$, pero no se especifica la incertidumbre de I. En la parte anterior de la práctica podemos ver en el enunciado de las tablas que $s(I) = 0,01A$, sin embargo, al no especificarse en esta parte y de ser 0,01 causaría problemas a la hora de hacer una regresión lineal, consideraremos que es nula o muy baja.

  \begin{figure}[H]
    \begin{table}[H]
      \centering
      \csvreader[
        tabular=|c|,
        table head=\hline Medida \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-4.csv}
        {}
        {\thecsvrow} \quad
      \csvreader[
        tabular=|c|c|,
        table head=\hline $I1(A)$ & $B1_{exp}(T)$ \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-4.csv}
        {I = \int, Bexp=\be}
        {\int & \be} \quad
      \csvreader[
        tabular=|c|c|,
        table head=\hline $I2(A)$ & $B2_{exp}(T)$ \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-5.csv}
        {I = \int, Bexp=\be}
        {\int & \be} \quad
      \csvreader[
        tabular=|c|c|,
        table head=\hline $I3(A)$ & $B3_{exp}(T)$ \\ \hline,
        late after last line=\\\hline,
        separator=semicolon
        ]{BH-6.csv}
        {I = \int, Bexp=\be}
        {\int & \be} \quad
    \end{table}
    \caption{Variación del campo magnético con la intensidad para a=R, a=R/2 y a=2R}
  \end{figure}

  \subsection{Representación gráfica}

  Utilizaremos un programa de \code{python} muy similar al anterior para representar los datos experimentales como puntos. Sin embargo, en esta ocasión tenemos que hacer un ajuste por mínimos cuadrados, que explicaremos en la siguiente sección.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{BH2.pgf}
    \caption{Campo magnético (B) frente a la intensidad (I) para tres separaciones de las bobinas (\textcolor{RoyalBlue}{a=R}, \textcolor{MediumSeaGreen}{a=R/2}, \textcolor{IndianRed}{a=2R})}
  \end{figure}

  \subsection{Ajuste por mínimos cuadrados}

  Para ajustar los una serie de datos que parezcan seguir una relación lineal podemos utilizar el método de \textbf{ajuste por mínimos cuadrados}. Al ser \textit{lineal}, podemos ajustarla por una recta general de la forma $y = \alpha + \beta x$. El problema a resolver sería conseguir la mejor aproximación \textit{a}, \textit{b} de los parámetros $\alpha, \beta$ y sus incertidumbres utilizando nuestra serie de parámetros $\left\{ x_i, y_i \right\}$. Sin embargo, en este caso sabemos que las rectas pasan por el origen (Puesto que para \textit{I=0}, \textit{B=0}), por lo tanto el parámetro \textit{a} va a ser igual a 0, ya que si sustituímos \textit{y=0} y \textit{x=0}, obtenemos $0 = \alpha + \beta \cdot 0$. Este tipo de regresión de la forma $y = \beta x$ llama \textbf{ajuste por mínimos cuadrados sin término independiente}, y es la que encaja con nuestra ecuación $B = c \cdot I$.

  Para ello minimizaremos la suma de los productos del peso estadístico de cada punto, $w_i$, por el cuadrado de la desviación de los datos, $[y_i - bx_i]^2$. Por lo tanto, la derivada respecto a \textit{b} debe de ser 0.
  \begin{gather}
    \chi^2 = \sum^{n}_{i=1} w_i[y_i - bx_i]^2 \label{ec:chi2} \\
    \frac{\partial \chi^2}{\partial b}=0 \label{ec:deriv}
  \end{gather}

  De aquí resultan dos posibles casos:

  \begin{enumerate}
    \item Si las incertidumbres de $x_i$ no son despreciables respecto a las de $y_i$. Obtenemos la siguiente ecuación: $\omega_i=\frac{1}{s^2(y_i)+b^2s^2(x_i)}$, que excede el nivel de este curso.
    \item Si por el contrario podemos despreciar las incertidumbres de $x_i$ respecto a $y_i$, podemos simplificar la ecuación anterior a $\omega_i=[s(y_i)]^{-2}$.
  \end{enumerate}

  En nuestro caso, estamos representando B ($y_i$) frente a I ($x_i$), y como ya comentamos la incertidumbre de I no está especificada por lo que consideraremos que es despreciable frente a la de B, así que podemos aplicar el segundo caso.

  Además, podemos considerar que las incertidumbres de $y_i$ permanecen constantes entre las diferentes medidas, por lo que también lo hará el peso estadístico $w = cte$. Finalmente, conseguimos la expresión matemática de \textit{b} en base a la serie de medidas $\left\{ x_i, y_i \right\}$, que sustituiremos por \textit{I} y \textit{B}. Tambien podemos calcular la desviación típica (s), la incertidumbre de b (s(b)) y el coeficiente de regresión lineal (r).
  \begin{gather}
    b = \frac{\sum_i{x_i y_i}}{\sum_i{x_i^2}} = \frac{\sum_i{I B}}{\sum_i{I^2}} \label{ec:regb} \\
    s = \sqrt{\frac{\sum_i{(y_i - bx_i)^2}}{n - 1}} = \sqrt{\frac{\sum_i{(B - bI)^2}}{n - 1}} \label{ec:regs} \\
    s(b) = \frac{s}{\sqrt{\sum_i{x_i^2}}} = \frac{s}{\sqrt{\sum_i{I^2}}} \label{ec:regsb} \\
    r = \frac{\sum_i{x_i y_i}}{\sqrt{(\sum_i{x_i^2}) \cdot (\sum_i{y_i^2})}} = \frac{\sum_i{I B}}{\sqrt{(\sum_i{I^2}) \cdot (\sum_i{B^2})}} \label{ec:regr}
  \end{gather}

  Implementaremos este procedimiento utilizando una vez más \code{python}. Lo haremos en una librería a parte para poder utilizarlo en el resto de las memorias. El código se describe a continuación, dónde los parámetros x e y son arrays de \code{numpy} o series de \code{pandas}, lo equivalente a una columna de nuestras tablas. Contienen la función \code{.sum()}, que hace un sumatorio de todos sus miembros. Como vemos, podemos operar antes de hacer la suma, por ejemplo, para calcular $\sum_i{x_i y_i}$.

  \begin{python}
    def reg_lin_b(x, y):
        n = len(x) #Numero de datos

        #Sumatorios necesarios
        sxy = (x*y).sum()
        sx2 = (x**2).sum()
        sybx = ((y - b*x)**2).sum()
        sy2 = (y**2).sum()

        b = sxy / sx2 #Pendiente de la recta
        s = (sybx / (n-1))**0.5 #Desviacion tipica
        sb = s / (sx2)**0.5 #Incertidumbre de b
        r = sxy / (sx2 * sy2)**0.5 #Coeficiente de regresion lineal

        return (b, s, sb, r)
  \end{python}

  Ahora crearemos el programa que nos permitirá representar las rectas junto a los puntos experimentales, y nos devolverá los datos de la regresión lineal.

  \begin{python}
    import pandas as pd
    import matplotlib.pyplot as plt

    #Datos, similarmente para las otras dos tablas
    d1 = pd.read_csv("BH-4.csv", sep=';', decimal=',')
    I1 = d1["I"]; Be1 = d1["Bexp"]

    #Regresion lineal sin termino independiente
    b1 = rl(I1, Be1)[0]
    xr1 = np.linspace(0, max(I1), 10); yr1 = b1 * xr1

    #Graficas
    plt.scatter(I1, Be1) #Experimental, puntos
    plt.plot(xr1, yr1) #Teorica, recta regresion lineal
  \end{python}

  Y obtenemos la siguiente gráfica con los parámetros de regresión indicados.

  \begin{figure}[H]
    %\centering
    \hspace{2.5em} \input{BH2R.pgf}
    \caption{Campo magnético (B) frente a la intensidad (I) para tres separaciones de las bobinas (\textcolor{RoyalBlue}{a=R}, \textcolor{MediumSeaGreen}{a=R/2}, \textcolor{IndianRed}{a=2R}) con regresión lineal simple sin término independiente}
  \end{figure}
  \begin{gather*}
    b_1 = 0,0006572 T/A \qquad s_1 = 9,3 \cdot 10^{-6} T \qquad sb_1 = 9,5 \cdot 10^{-7} T/A \qquad r_1 = 0,99998 \\
    b_2 = 0,000843 T/A \qquad s_2 = 1,3 \cdot 10^{-5} T \qquad sb_2 = 1,3 \cdot 10^{-6} T/A \qquad r_2 = 0,99997 \\
    b_3 = 0,000327 T/A \qquad s_3 = 1,1 \cdot 10^{-5} T \qquad sb_3 = 1,1 \cdot 10^{-6} T/A \qquad r_3 = 0,99990
  \end{gather*}

  \subsection{Cálculo de la permeabilidad magnética}

  Ahora que tenemos las pendientes de las tres rectas, podemos calcular la permeabilidad magnética con las ecuaciones que describimos antes (\ref{ec:mu}). Tenemos así:
  \begin{gather*}
    \mu_{0(1)} = \frac{b_1 R \cdot 5 \sqrt{5}}{N \cdot 2^3} = \frac{0,0006572 \cdot 0,2 \cdot 5 \sqrt{5}}{154 \cdot 2^3} = 1,193 \cdot 10^{-6} \frac{m \cdot T}{A} \\
    \mu_{0(2)} = \frac{b_2 R \cdot 17 \sqrt{17}}{N \cdot 2^6} = \frac{0,000843 \cdot 0,2 \cdot 17 \sqrt{17}}{154 \cdot 2^6} = 1,199 \cdot 10^{-6} \frac{m \cdot T}{A}\\
    \mu_{0(3)} = \frac{b_3 R \cdot 2 \sqrt{2}}{N} = \frac{0,000327 \cdot 0,2 \cdot 2 \sqrt{2}}{154} = 1,201 \cdot 10^{-6} \frac{m \cdot T}{A}
  \end{gather*}

  Calcular la incertidumbre de nuestras medidas es sencillo utilizando propagación de incertidumbres. A partir de la expresión \ref{ec:smu} obtenemos estos resultados:
  \begin{gather*}
    s(\mu_{0(1)}) = \frac{s(b_1) R \cdot 5 \sqrt{5}}{N \cdot 2^3} = 1,7 \cdot 10^{-9} \frac{m \cdot T}{A} \\
    s(\mu_{0(2)}) = \frac{s(b_2) R \cdot 17 \sqrt{17}}{N \cdot 2^6} = 1,8 \cdot 10^{-9} \frac{m \cdot T}{A} \\
    s(\mu_{0(3)}) = \frac{s(b_3) R \cdot 2 \sqrt{2}}{N} = 4,0 \cdot 10^{-9} \frac{m \cdot T}{A}
  \end{gather*}

  Podemos observar que los resultados se ajustan bastante bien a la constante de permeabilidad magnética original, el ligero desvío se produce por el mismo motivo que las gráficas experimentales no coinciden del todo con las teóricas, probablemente pequeños fallos en la obtención de los datos en el laboratorio. De cualquier manera, podemos afirmar con seguridad que $\mu_0$ tiene un valor muy similar al obtenido.
  \begin{gather*}
    \mu_0 = 4\pi 10^-7 \frac{m \cdot T}{A} \approx 1,257 \cdot 10^-6 \\
    \mu_0 \approx 1,193 \cdot 10^{-6} \pm 1,7 \cdot 10^{-9} \approx 1,199 \cdot 10^{-6} \pm 1,8 \cdot 10^{-9} \approx 1,201 \cdot 10^{-6} \pm 4,0 \cdot 10^{-9}
  \end{gather*}

  \newpage
  \section{Conclusiones PENDIENTE}

  \newpage
  \thispagestyle{plain}
  \mbox{}

  \newpage
  \part{Curva de Carga}

  \section{Objetivos}

  En esta práctica trabajaremos con un \textbf{circuito RC}, o lo que es lo mismo, que tiene una resistencia y un condensador. Podemos verlo en la figura a continuación:

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) to[voltage source, l=V] (0,3)
      to[R, l=R] (3,3)
      to[capacitor, l=C] (3,0) -- (0,0);
    \end{circuitikz}
    \caption{Circuito RC}
  \end{figure}

  Mediremos la curva de carga del condensador en tres escenarios diferentes:

  \begin{itemize}[label=$-$]
    \item Mantentiendo \textbf{V} y \textbf{C} constantes, variando \textbf{R}
    \item Mantentiendo \textbf{R} y \textbf{V} constantes, variando \textbf{C}
    \item Mantentiendo \textbf{C} y \textbf{R} constantes, variando \textbf{V}
  \end{itemize}

  \subsection{Expresión de la intensidad}

  Si utilizamos la \textbf{ley de Ohm} en el circuito, obtenemos una ecuación diferencial de \textit{Q(t)}, y utilizando su resultado podemos calcular \textit{I(t)} dado que $I(t) = \partial Q /\partial t$
  \begin{gather}
    \Delta V = \Delta V_R + \Delta V_C = IR + \frac{Q}{C} = \frac{\partial Q}{\partial t}R + \frac{Q}{C} \nonumber \\
    Q(t) = C \Delta V (1-e^{\frac{-t}{RC}}) \nonumber \\
    I(t) = \frac{\partial Q}{\partial t} = \frac{\Delta V}{R} e^{\frac{-t}{RC}} \label{ec:i}
  \end{gather}

  \subsection{Diagrama}

  Pese a que no explicaremos de manera pormenorizada el montaje experimental, daremos unas nociones básicas del funcionamiento del circuito y cómo tomaremos las medidas.

  Necesitamos una fuente de alimentacion que conectaremos a una resistencia y un condensador. Además, añadiremos un amperímetro que nos permita visualizar la intensidad. También colocaremos otro circuito de descarga, para que moviendo un interruptor podamos conectar el condensador directamente a una resistencia muy pequeña para que se descargue de manera casi instantánea. En el siguiente diagrama se ve una posible configuración:

  \begin{figure}[H]
    \centering
    \begin{circuitikz}[european]
      \draw (0,0) node[cute spdt up](S){}
      (S.out 1) -- ++(2,0) to[capacitor, l=C] ++(0,-3) -- ++(0,-1) -- ++(-1, 0)
      to[ammeter, l=A] ++(-2, 0)
      to[R, l=R] ++(0,1.79)
      to[voltage source, l=V] ++(0,1.79) -- (S.in)
      (S.out 2) -- ++(1,0) to[R, l=$100\Omega$] ++(0,-3.18);
    \end{circuitikz}
    \caption{Montaje experimental}
  \end{figure}

  Al tomar las medidas, debemos de asegurarnos de que el condensador esté descargado. Conectaremos el condensador a la corriente (y la resistencia) y anotaremos el tiempo cada vez que el amperímetro varíe el $0,1 \mu A$, su precisión instrumental.

  \subsection{Incertidumbres}

  Ya sabemos que la incertidumbre experimental del amperímetro es de $0,1 \mu A = 10^{-7} A$, sin embargo en el caso del tiempo debemos realizar una matización. Pese a que el cronómetro tiene una precisión experimental de $0,01 s$, no podemos tomarla cómo tal. Hay un desfase entre que el amperímetro cambia y nosotros anotamos el tiempo, por lo que tenemos que tener en cuenta las limitaciones de nuestra propia percepción. Estimaremos que la incertidumbre del tiempo es de $0,3 s$.

  Para representar la curva de carga preferiremos hacer uso del logaritmo de la intensidad ($\ln{I}$) en lugar de la medida directa, por lo que procederemos a calcular su fórmula de propagación de incertidumbres.
  \begin{equation}
    s(\ln{I}) = \sqrt{\left( \frac{\partial \ln{I}}{\partial I} \right)^2 \cdot s^2(I)} = \sqrt{\frac{1}{I^2} \cdot s^2(I)} = \frac{s(I)}{I} \label{ec:slni}
  \end{equation}

  \newpage
  \section{Medidas con \textbf{V} y \textbf{C} constantes, variando \textbf{R}}

  En la primera experiencia, dejaremos $\mathbf{V = 10V}$ y $\mathbf{C = 3 \cdot 10^{-5} F}$ constantes, y cambiaremos la resistencia. Para cuatro valores distintos obtenemos los datos expuestos.

  \subsection{Tablas de datos}

  Como discutimos en el apartado anterior, la incertidumbre del tiempo y de la intensidad son constantes a lo largo de los experimentos, siendo respectivamente $s(T) = 0,3 s$ y $s(I) = 10^{-7} A$, por lo que no las incluiremos en las tablas. La del logaritmo de I si que varía, y se calcula utilizando la ecuación \ref{ec:slni}. Presentamos los resultados a continuación.

  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{R_1 = 4,7 \cdot 10^6 \Omega}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_1(s)$ & $I_1(A)$ & $\ln{I_1} \pm s(I_1) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{22},
      separator=semicolon
      ]{CC-1.csv}
      {T1=\Ti, I1=\Ii, LnI1=\LnIi, sLnI1=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}
  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{R_2 = 6,9 \cdot 10^6 \Omega}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_2(s)$ & $I_2(A)$ & $\ln{I_2} \pm s(I_2) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{14},
      separator=semicolon
      ]{CC-1.csv}
      {T2=\Ti, I2=\Ii, LnI2=\LnIi, sLnI2=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}

  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{R_3 = 3,2 \cdot 10^6 \Omega}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_3(s)$ & $I_3(A)$ & $\ln{I_3} \pm s(I_3) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{100},
      separator=semicolon
      ]{CC-1.csv}
      {T3=\Ti, I3=\Ii, LnI3=\LnIi, sLnI3=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}
  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{R_4 = 5 \cdot 10^6 \Omega}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_4(s)$ & $I_4(A)$ & $\ln{I_4} \pm s(I_4) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{14},
      separator=semicolon
      ]{CC-1.csv}
      {T4=\Ti, I4=\Ii, LnI4=\LnIi, sLnI4=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}

  \newpage
  \subsection{Representación gráfica}

  Primero, representaremos los datos de $I_i$ frente a $T_i$ directamente. Utilizando \code{pandas} y \code{matplotlib} de una manera muy similar a la primera práctica, obtenemos la siguiente gráfica:

  \begin{figure}[H]
    %\centering
    \hspace{3em} \input{CC-1.pgf}
    \caption{Intensidad (I) frente a tiempo (T) variando la resistencia (R)}
  \end{figure}

  Como podemos ver, las curvas parecen indicar algun tipo de relación de decaimiento exponencial. Para observarlo con mayor claridad, sustituiremos I por su logaritmo ($\ln{I}$). Si obtenemos rectas, eso significará que en efecto es una relación exponencial. Además, nos permitirá hacer un ajuste lineal de los datos.

  \begin{figure}[H]
    %\centering
    \hspace{1.8em} \input{CC-1L.pgf}
    \caption{Logaritmo de la intensidad ($\ln{I}$) frente a tiempo (T) variando la resistencia (R)}
  \end{figure}

  Las lineas se cruzan demasiado al representarlas todas juntas, por lo que dividiremos la gráfica en cuatro.

  \begin{figure}[H]
    %\centering
    \hspace{0.2em} \input{CC-1LM.pgf}
    \caption{Logaritmo de la intensidad ($\ln{I}$) frente a tiempo (T) variando la resistencia (R)}
  \end{figure}

  Ahora sí, podemos obvservar que en efecto se ajustan mucho a lineas rectas. El siguiente paso será hacer una regresión lineal para verificar cúal sería la línea teórica para ellas.

  \newpage
  \subsection{Ajuste por mínimos cuadrados}

  En esta ocasión, la incertidumbre de $\ln{I}$ ($s(\ln{I}) = s(y_i)$) varía con el tiempo, cómo indican las tablas. Por lo tanto, tendremos que realizar un ajuste por mínimos cuadrados ponderado, a diferencia del simple que hicimos en las Bobinas.

  Además, será un ajuste con término independiente, porque en $T=0$, $\ln{I} \ne 0$, de la forma $y_i = a + bx_i$. Las fórmulas correspondientes a este ajuste son:
  \begin{gather}
    a = \frac{(\sum_i{w_i y_i})(\sum_i{w_i x_i^2}) - (\sum_i{w_i x_i})(\sum_i{w_i x_i y_i})}{\Delta} \label{ec:regwa} \\
    b = \frac{(\sum_i{w_i})(\sum_i{w_i x_i y_i}) - (\sum_i{w_i x_i})(\sum_i{w_i y_i})}{\Delta} \label{ec:regwb} \\
    s(a) = \sqrt{\frac{\sum_i{w_i x_i^2}}{\Delta}} \qquad
    s(b) = \sqrt{\frac{\sum_i{w_i}}{\Delta}} \label{ec:regwsab} \\
    s = \sqrt{\frac{n}{(n - 2) \sum_i{w_i}} \left[ \sum_i{w_i(y_i - a - bx_i)^2} \right]} \label{ec:regws} \\ \vspace{0.3cm}
    r = \frac{(\sum_i{w_i})(\sum_i{w_i x_i y_i}) - (\sum_i{w_i x_i})(\sum_i{w_i y_i})}{\sqrt{[(\sum_i{w_i})(\sum_i{w_i x_i^2}) - (\sum_i{w_i x_i})^2] [(\sum_i{w_i})(\sum_i{w_i y_i^2}) - (\sum_i{w_i y_i})^2]}} \label{ec:regwr} \\
    \Delta = \begin{vmatrix}
              \sum_i{w_i} & \sum_i{w_i x_i} \\
              \sum_i{w_i x_i} & \sum_i{w_i x_i^2}
             \end{vmatrix} \qquad
    w = \frac{1}{sy^2}
  \end{gather}

  Lo implementamos en \code{python} con el siguiente código, de manera similar a la anterior regresión.

  \begin{python}
    def reg_lin_w(x, y, sy):
        n = len(x); w = sy**(-2)

        sw = w.sum(); swxy = (w*x*y).sum()
        swx = (w*x).sum(); swy = (w*y).sum()
        swx2 = (w*x**2).sum(); swy2 = (w*y**2).sum()
        det = sw * swx2 - swx**2

        a = (swy*swx2 - swx*swxy) / det
        b = (sw*swxy - swx*swy) / det

        sa = (swx2 / det)**0.5
        sb = (sw / det)**0.5

        swab = (w*(y - a - b*x)**2).sum()
        s = ((n / ((n-2) * sw)) * swab)**0.5

        r = (sw*swxy - swx*swy) / ((sw*swx2 - swx**2) * (sw*swy2 - swy**2))**0.5

        return (a, b, s, sa, sb, r)
  \end{python}

  Además, añadimos un programa específico para nuestros datos, que iterará entre los distintos puntos y hará una regresión lineal para cada una de las resistencias. Con todo eso, obtenemos las siguientes gráficas con sus correspondientes parámetros de ajuste:

  \begin{figure}[H]
    %\centering
    \hspace{0.2em} \input{CC-1LR.pgf}
    \caption{Logaritmo de la intensidad ($\ln{I}$) frente a tiempo (T) variando la resistencia (R) con ajuste por mínimos cuadrados ponderado con término independiente}
  \end{figure}

  \begin{gather*}
    a_1 = -13,041 \pm 0,022 \quad b_1 = -0,00798 \pm 0,00038 s^{-1} \quad s_1 = 0,015 \quad r_1 = 0,9991 \\
    a_2 = -13,465 \pm 0,043 \quad b_2 = -0,00571 \pm 0,00054 s^{-1} \quad s_2 = 0,022 \quad r_2 = 0,998 \\
    a_3 = -12,684 \pm 0,013 \quad b_3 = -0,01045 \pm 0,00031 s^{-1} \quad s_3 = 0,0044 \quad r_3 = 0,99991 \\
    a_4 = -13,111 \pm 0,026 \quad b_4 = -0,00752 \pm 0,00042 s^{-1} \quad s_4 = 0,020 \quad r_4 = 0,998
  \end{gather*}

  \newpage
  \subsection{Interpretación}

  Ahora que tenemos los términos de ajuste de las distintas rectas, a y b correspondientes a $y_i = a + bx_i$, podemos interpretar su significado. Tomaremos la siguiente expresión y la convertiremos para obtener $\ln{I}$ en función del tiempo.
  \begin{equation}
    I(T) = \frac{\Delta V}{R} e^{-T/RC} \qquad \ln{I(T)} = \ln{\frac{\Delta V}{R}} - \frac{1}{RC} \cdot T \label{ec:I}
  \end{equation}

  Podemos justaponer esta ecuación a $y_i = a + bx_i$ siendo $y_i = \ln{I(T)}$ y $x_i = T$ para obtener los parámetros a y b teóricos:
  \begin{equation}
    a = \ln{\frac{\Delta V}{R}} \qquad b = - \frac{1}{RC} \label{ec:abteo}
  \end{equation}

  Ahora calcularemos los distintos valores de a y b teóricos para comprobar nuestros resultados experimentales:
  \begin{gather*}
    a_1 = \ln{\frac{10}{4,7 \cdot 10^6}} = -13,060 \qquad b_1 = - \frac{1}{4,7 \cdot 10^6 \cdot 3 \cdot 10^{-5}} = -0,00709 s^{-1} \\
    a_2 = \ln{\frac{10}{6,9 \cdot 10^6}} = -13,444 \qquad b_2 = - \frac{1}{6,9 \cdot 10^6 \cdot 3 \cdot 10^{-5}} = -0,00483 s^{-1} \\
    a_3 = \ln{\frac{10}{3,2 \cdot 10^6}} = -12,676 \qquad b_3 = - \frac{1}{3,2 \cdot 10^6 \cdot 3 \cdot 10^{-5}} = -0,01042 s^{-1} \\
    a_4 = \ln{\frac{10}{5,0 \cdot 10^6}} = -13,122 \qquad b_4 = - \frac{1}{5,0 \cdot 10^6 \cdot 3 \cdot 10^{-5}} = -0,00667 s^{-1}
  \end{gather*}

  Debemos calcular la incertidumbre de a y b mediante propaganción de incertidumbres. Tomamos $s(\Delta V) = 0,1V$, y tanto s(C) como s(R) serán un 5\% de su valor nominal. Primero vemos las incertidumbres de R (múltiples valores) y C.
  \begin{gather}
    s(R_1) = 0,05 \cdot 4,7 \cdot 10^6 = 2,35 \cdot 10^5 \Omega \qquad s(R_2) = 0,05 \cdot 6,9 \cdot 10^6 = 3,45 \cdot 10^5 \Omega \nonumber \\
    s(R_3) = 0,05 \cdot 3,2 \cdot 10^6 = 1,6 \cdot 10^5 \Omega \qquad s(R_4) = 0,05 \cdot 5,0 \cdot 10^6 = 2,5 \cdot 10^5 \Omega \nonumber \\
    s(C) = 0,05 \cdot 3 \cdot 10^{-5} = 1,5 \cdot 10^{-6} F \nonumber
  \end{gather}

  Ahora tomaremos la incertidumbre de los términos independientes, $a_i$:
  \begin{gather}
    s(a) = \sqrt{\left(\frac{\partial a}{\partial \Delta V}\right)^2 \cdot s(\Delta V)^2 + \left(\frac{\partial a}{\partial R}\right)^2 \cdot s(R)^2} = \sqrt{\left(\frac{1}{\Delta V}\right)^2 \cdot s(\Delta V)^2 + \left(\frac{-1}{R}\right)^2 \cdot s(R)^2} \label{ec:sateo} \\
    s(a_1) = \sqrt{\frac{1}{10^2} \cdot 0,1^2 + \left(\frac{-1}{4,7 \cdot 10^6}\right)^2 \cdot (2,35 \cdot 10^5)^2} = 0,051 \nonumber \\
    s(a_2) = \sqrt{\frac{1}{10^2} \cdot 0,1^2 + \left(\frac{-1}{6,9 \cdot 10^6}\right)^2 \cdot (3,45 \cdot 10^5)^2} = 0,051 \nonumber \\
    s(a_3) = \sqrt{\frac{1}{10^2} \cdot 0,1^2 + \left(\frac{-1}{3,2 \cdot 10^6}\right)^2 \cdot (1,6 \cdot 10^5)^2} = 0,051 \nonumber \\
    s(a_4) = \sqrt{\frac{1}{10^2} \cdot 0,1^2 + \left(\frac{-1}{5,0 \cdot 10^6}\right)^2 \cdot (2,5 \cdot 10^5)^2} = 0,051 \nonumber \\
    s(a_1) = s(a_2) = s(a_3) = s(a_4) = 0,051 \nonumber
  \end{gather}

  Y por último la incertidumbre de las pendientes de las rectas, $b_i$:
  \begin{gather}
    s(b) = \sqrt{\left(\frac{\partial b}{\partial R}\right)^2 \cdot s(R)^2 + \left(\frac{\partial b}{\partial C}\right)^2 \cdot s(C)^2} = \sqrt{\left(\frac{1}{C R^2}\right)^2 \cdot s(R)^2 + \left(\frac{1}{C^2 R}\right)^2 \cdot s(C)^2} \label{ec:sbteo} \\
    s(b_1) = \sqrt{\left(\frac{1}{3 \cdot 10^{-5} \cdot (4,7 \cdot 10^6)^2}\right)^2 \cdot (2,35 \cdot 10^5)^2 + \left(\frac{1}{(3 \cdot 10^{-5})^2 \cdot 4,7 \cdot 10^6}\right)^2 \cdot (1,5 \cdot 10^{-6})^2} \nonumber \\
    s(b_2) = \sqrt{\left(\frac{1}{3 \cdot 10^{-5} \cdot (6,9 \cdot 10^6)^2}\right)^2 \cdot (3,45 \cdot 10^5)^2 + \left(\frac{1}{(3 \cdot 10^{-5})^2 \cdot 6,9 \cdot 10^6}\right)^2 \cdot (1,5 \cdot 10^{-6})^2} \nonumber \\
    s(b_3) = \sqrt{\left(\frac{1}{3 \cdot 10^{-5} \cdot (3,2 \cdot 10^6)^2}\right)^2 \cdot (1,6 \cdot 10^5)^2 + \left(\frac{1}{(3 \cdot 10^{-5})^2 \cdot 3,2 \cdot 10^6}\right)^2 \cdot (1,5 \cdot 10^{-6})^2} \nonumber \\
    s(b_4) = \sqrt{\left(\frac{1}{3 \cdot 10^{-5} \cdot (5,0 \cdot 10^6)^2}\right)^2 \cdot (2,5 \cdot 10^5)^2 + \left(\frac{1}{(3 \cdot 10^{-5})^2 \cdot 5,0 \cdot 10^6}\right)^2 \cdot (1,5 \cdot 10^{-6})^2} \nonumber \\
    s(b_1) = 0,00050 s^{-1} \quad s(b_2) = 0,00034 s^{-1} \quad s(b_3) = 0,00074 s^{-1} \quad s(b_4) = 0,00047 s^{-1} \nonumber
  \end{gather}

  Tan solo nos queda comparar los valores de a y b teóricos y experimentales. Podemos ver que son todos razonablemente cercanos y que cumplen las tendencias. Cualquier desviación pequeña puede deberse al procedimiento de medida y a los errores en el laboratorio. Consideramos comprobada la ley en esta situación.

  Antes de dejar el experimento, analizaremos el valor I(0). Si nos referimos a la ecuación \ref{ec:I} y sustituímos t por 0 nos queda $I(0) = \frac{\Delta V}{R}e^{0/RC}$, simplificando $I(0) = \frac{\Delta V}{R}$. Podemos comprobar que el logaritmo de I(0) nos da el término independiente del ajuste, o lo que es lo mismo, la oordenada en el origen, lo cual tiene completo sentido $(\ln{I(0)} = a)$ y coincide con nuestros datos.


  \newpage
  \section{Medidas con \textbf{R} y \textbf{V} constantes, variando \textbf{C}}

  En esta segunda experiencia repetiremos el mismo procedimiento, pero esta vez dejando $\mathbf{V = 10V}$ y $\mathbf{R = 5,7 \cdot 10^6 \Omega}$ constantes y cambiando los valores del condensador. Realizaremos pruebas con cuatro condensadores diferentes.

  \subsection{Tablas de datos}

  Igual que en el apartado anterior, la incertidumbre del tiempo y de la intensidad son constantes a lo largo de los experimentos, siendo respectivamente $s(T) = 0,3 s$ y $s(I) = 10^{-7} A$ mientras que la del logaritmo de I varía y es calculada con \ref{ec:slni}. Presentamos las tablas obtenidas a continuación.

  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{C_1 = 4,7 \cdot 10^{-6} F}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_1(s)$ & $I_1(A)$ & $\ln{I_1} \pm s(I_1) (A)$ \\ \hline,
      late after last line=\\\hline,
      separator=semicolon
      ]{CC-2.csv}
      {T1=\Ti, I1=\Ii, LnI1=\LnIi, sLnI1=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}
  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{C_2 = 1,0 \cdot 10^{-5} F}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_2(s)$ & $I_2(A)$ & $\ln{I_2} \pm s(I_2) (A)$ \\ \hline,
      late after last line=\\\hline,
      separator=semicolon
      ]{CC-2.csv}
      {T2=\Ti, I2=\Ii, LnI2=\LnIi, sLnI2=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}

  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{C_3 = 3,0 \cdot 10^{-5} F}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_3(s)$ & $I_3(A)$ & $\ln{I_3} \pm s(I_3) (A)$ \\ \hline,
      late after last line=\\\hline,
      separator=semicolon
      ]{CC-2.csv}
      {T3=\Ti, I3=\Ii, LnI3=\LnIi, sLnI3=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}
  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{C_4 = 6,0 \cdot 10^{-5} F}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_4(s)$ & $I_4(A)$ & $\ln{I_4} \pm s(I_4) (A)$ \\ \hline,
      late after last line=\\\hline,
      separator=semicolon
      ]{CC-2.csv}
      {T4=\Ti, I4=\Ii, LnI4=\LnIi, sLnI4=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}

  \newpage
  \subsection{Representación gráfica}

  Representamos directamente los datos de $I_i$ frente a $T_i$ utilizando el mismo programa.

  \begin{figure}[H]
    %\centering
    \hspace{3em} \input{CC-2.pgf}
    \caption{Intensidad (I) frente a tiempo (T) variando la resistencia (R)}
  \end{figure}

  Vuelve a aparecer el decaimiento exponencial, por lo que cambiaremos de nuevo I por su logaritmo y representaremos las gráficas otra vez. Como en esta ocasión la gráfica queda mucho más clara y se distinguen perfectamente las lineas, no la separaremos como antes.

  \begin{figure}[H]
    %\centering
    \hspace{1.8em} \input{CC-2L.pgf}
    \caption{Logaritmo de la intensidad ($\ln{I}$) frente a tiempo (T) variando la resistencia (R)}
  \end{figure}

  \subsection{Ajuste por mínimos cuadrados}

  Ejecutaremos el programa de regresión lineal ponderada con término independiente que construímos en el apartado anterior y dibujaremos de nuevo la gráfica con sus parámetros de ajuste.

  \begin{figure}[H]
    %\centering
    \hspace{0.2em} \input{CC-2LR.pgf}
    \caption{Logaritmo de la intensidad ($\ln{I}$) frente a tiempo (T) variando la resistencia (R) con ajuste por mínimos cuadrados ponderado con término independiente}
  \end{figure} \vspace{0cm}
  \begin{gather*}
    a_1 = -13,244 \pm 0,029 \quad b_1 = -0,0386 \pm 0,0025 s^{-1} \quad s_1 = 0,011 \quad r_1 = 0,9995 \\
    a_2 = -13,250 \pm 0,029 \quad b_2 = -0,0181 \pm 0,0012 s^{-1} \quad s_2 = 0,013 \quad r_2 = 0,993 \\
    a_3 = -13,245 \pm 0,029 \quad b_3 = -0,00584 \pm 0,00038 s^{-1} \quad s_3 = 0,0095 \quad r_3 = 0,9996 \\
    a_4 = -13,255 \pm 0,029 \quad b_4 = -0,00299 \pm 0,00020 s^{-1} \quad s_4 = 0,018 \quad r_4 = 0,998
  \end{gather*}

  \subsection{a y b teóricos}

  Cómo en el apartado anterior, utilizaremos las ecuaciones \ref{ec:abteo}, \ref{ec:sateo} y \ref{ec:sbteo} para calcular a y b teóricos junto a sus incertidumbres, y vemos que son muy similares. Por comodidad, simplemente indicaremos el resultado final tras aplicar esas fórmulas.
  \begin{gather*}
    a_1 = -13,253 \pm 0,051 \quad b_1 = -0,0373 \pm 0,0026 s^{-1} \\
    a_2 = -13,253 \pm 0,051 \quad b_2 = -0,0175 \pm 0,0012 s^{-1} \\
    a_3 = -13,253 \pm 0,051 \quad b_3 = -0,00585 \pm 0,00041 s^{-1} \\
    a_4 = -13,253 \pm 0,051 \quad b_4 = -0,00292 \pm 0,00021 s^{-1}
  \end{gather*}

  \newpage
  \section{Medidas con \textbf{C} y \textbf{R} constantes, variando \textbf{V}}

  En la última experiencia repetiremos el mismo procedimiento que en las dos anteriores, aunque ahora fijaremos $\mathbf{C = 10^{-5} F}$ y $\mathbf{R = 4,4 \cdot 10^6 \Omega}$, y variaremos la diferencia de potencial en cuatro experimentos distintos.

  \subsection{Tablas de datos}

  La incertidumbre del tiempo y de la intensidad son constantes para todas las tablas, siendo respectivamente $s(T) = 0,3 s$ y $s(I) = 10^{-7} A$. Sin embargo, $s(\ln{I})$ cambia con cada medida y tenemos que calcularla usando \ref{ec:slni}. A continuación se exponen las tablas obtenidas.

  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{V_1 = 8,5V}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_1(s)$ & $I_1(A)$ & $\ln{I_1} \pm s(I_1) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{20},
      separator=semicolon
      ]{CC-3.csv}
      {T1=\Ti, I1=\Ii, LnI1=\LnIi, sLnI1=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}
  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{V_2 = 11,5V}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_2(s)$ & $I_2(A)$ & $\ln{I_2} \pm s(I_2) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{26},
      separator=semicolon
      ]{CC-3.csv}
      {T2=\Ti, I2=\Ii, LnI2=\LnIi, sLnI2=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}

  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{V_3 = 10,2V}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_3(s)$ & $I_3(A)$ & $\ln{I_3} \pm s(I_3) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{23},
      separator=semicolon
      ]{CC-3.csv}
      {T3=\Ti, I3=\Ii, LnI3=\LnIi, sLnI3=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}
  \begin{minipage}[t]{0.5\textwidth}
    \centering
    $\mathbf{V_4 = 6,0V}$ \vspace{0.5cm}
    \csvreader[
      tabular=|c|c|c|,
      table head=\hline $T_4(s)$ & $I_4(A)$ & $\ln{I_4} \pm s(I_4) (A)$ \\ \hline,
      late after last line=\\\hline,
      filter test= \ifnumless{\thecsvrow}{14},
      separator=semicolon
      ]{CC-3.csv}
      {T4=\Ti, I4=\Ii, LnI4=\LnIi, sLnI4=\sLnIi}
      {\Ti & \Ii & $\LnIi \pm \sLnIi$}
  \end{minipage}

  \newpage
  \subsection{Representación gráfica}

  Representamos directamente los datos de $I_i$ frente a $T_i$ utilizando el mismo programa.

  \begin{figure}[H]
    %\centering
    \hspace{3em} \input{CC-3.pgf}
    \caption{Intensidad (I) frente a tiempo (T) variando la resistencia (R)}
  \end{figure}

  Se observa decaimiento exponencial, así que representaremos $\ln{I}$ en lugar de I.

  \begin{figure}[H]
    %\centering
    \hspace{1.8em} \input{CC-3L.pgf}
    \caption{Logaritmo de la intensidad ($\ln{I}$) frente a tiempo (T) variando la resistencia (R)}
  \end{figure}

  En esta ocasión las lineas están bastante cerca unas de otras, pero tienen una cualidad importante que se ve mejor si se representan juntas. A primera vista parece que son paralelas, y separando las gráficas perderíamos ese detalle. Tendremos que realizar un ajuste para comprobar si esta suposición es correcta.

  \subsection{Ajuste por mínimos cuadrados}

  Ejecutaremos el programa de regresión lineal ponderada con término independiente que construímos en el apartado anterior y dibujaremos de nuevo la gráfica con sus parámetros de ajuste

  \begin{figure}[H]
    %\centering
    \hspace{0.2em} \input{CC-3LR.pgf}
    \caption{Logaritmo de la intensidad ($\ln{I}$) frente a tiempo (T) variando la resistencia (R) con ajuste por mínimos cuadrados ponderado con término independiente}
  \end{figure}
  \begin{gather*}
    a_1 = -13,099 \pm 0,026 \quad b_1 = -0,0241 \pm 0,0014 s^{-1} \quad s_1 = 0,013 \quad r_1 = 0,9993 \\
    a_2 = -12,829 \pm 0,018 \quad b_2 = -0,02352 \pm 0,00090 s^{-1} \quad s_2 = 0,015 \quad r_2 = 0,9991 \\
    a_3 = -12,965 \pm 0,021 \quad b_3 = -0,0231 \pm 0,0011 s^{-1} \quad s_3 = 0,019 \quad r_3 = 0,998 \\
    a_4 = -13,495 \pm 0,041 \quad b_4 = -0,0231 \pm 0,0023 s^{-1} \quad s_4 = 0,013 \quad r_4 = 0,9993
  \end{gather*}

  \subsection{a y b teóricos}

  Finalmente, volveremos a utilizar las ecuaciones \ref{ec:abteo}, \ref{ec:sateo} y \ref{ec:sbteo} para calcular a y b teóricos junto a sus incertidumbres. Como podemos observar los resultados son prácticamente idénticos.
  \begin{gather*}
    a_1 = -13,157 \pm -0,051 \quad b_1 = -0,0227 \pm -0,0016 s^{-1} \\
    a_2 = -12,855 \pm -0,051 \quad b_2 = -0,0227 \pm -0,0016 s^{-1} \\
    a_3 = -12,975 \pm -0,051 \quad b_3 = -0,0227 \pm -0,0016 s^{-1} \\
    a_4 = -13,505 \pm -0,053 \quad b_4 = -0,0227 \pm -0,0016 s^{-1}
  \end{gather*}

  \newpage
  \section{Conclusiones: PENDIENTE}








\end{document}
